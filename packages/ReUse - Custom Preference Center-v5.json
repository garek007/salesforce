{"appVersion":"240.3.40","id":"cbb30cec-c51c-4822-b810-9932717baf36","name":"ReUse - Custom Preference Center","version":5,"modelVersion":"4","references":{"automations/062a48b9-6e6b-436e-8789-0f4b18100d87":[{"identifier":"queryActivities/43d48268-07e3-4c31-be08-e60000f5edfa","relationship":"required"},{"identifier":"queryActivities/955881f4-6cb6-4ff3-917e-0e26af7f7c42","relationship":"required"},{"identifier":"queryActivities/707c95b8-6dcc-4bc8-922b-2f86e3ac2ca6","relationship":"required"},{"identifier":"queryActivities/ef1dbe3f-9166-4c80-9cd4-b3f03dac00db","relationship":"required"},{"identifier":"categories/418749","relationship":"required"}],"categories/418749":[{"identifier":"categories/418426","relationship":"required"}],"queryActivities/955881f4-6cb6-4ff3-917e-0e26af7f7c42":[{"identifier":"dataExtensions/2634db59-79a9-ed11-b866-48df376a1421","relationship":"required"},{"identifier":"dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421","relationship":"required"},{"identifier":"categories/418750","relationship":"required"}],"queryActivities/ef1dbe3f-9166-4c80-9cd4-b3f03dac00db":[{"identifier":"dataExtensions/2634db59-79a9-ed11-b866-48df376a1421","relationship":"required"},{"identifier":"dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421","relationship":"required"},{"identifier":"categories/418750","relationship":"required"}],"queryActivities/707c95b8-6dcc-4bc8-922b-2f86e3ac2ca6":[{"identifier":"dataExtensions/2634db59-79a9-ed11-b866-48df376a1421","relationship":"required"},{"identifier":"dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421","relationship":"required"},{"identifier":"categories/418750","relationship":"required"}],"dataExtensions/2634db59-79a9-ed11-b866-48df376a1421":[{"identifier":"categories/418405","relationship":"required"}],"dataExtensions/2734db59-79a9-ed11-b866-48df376a1421":[{"identifier":"categories/418405","relationship":"required"}],"categories/418405":[{"identifier":"categories/398886","relationship":"required"}],"categories/398886":[],"queryActivities/43d48268-07e3-4c31-be08-e60000f5edfa":[{"identifier":"dataExtensions/2634db59-79a9-ed11-b866-48df376a1421","relationship":"required"},{"identifier":"dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421","relationship":"required"},{"identifier":"categories/418750","relationship":"required"}],"cloudPageCollections/1125":[],"categories/418750":[{"identifier":"categories/418412","relationship":"required"}],"categories/418426":[{"identifier":"categories/398897","relationship":"required"}],"categories/398897":[],"categories/418412":[{"identifier":"categories/398892","relationship":"required"}],"dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421":[{"identifier":"categories/418437","relationship":"required"}],"categories/418437":[{"identifier":"categories/418436","relationship":"required"}],"categories/418436":[{"identifier":"categories/398886","relationship":"required"}],"categories/398892":[],"landingPages/929574-2129":[{"identifier":"primaryLandingPages/929574-2129","relationship":"required"},{"identifier":"dataExtensions/2634db59-79a9-ed11-b866-48df376a1421","relationship":"required"},{"identifier":"dataExtensions/2734db59-79a9-ed11-b866-48df376a1421","relationship":"required"},{"identifier":"categories/398902","relationship":"required"}],"landingPages/929575-2130":[{"identifier":"primaryLandingPages/929575-2130","relationship":"required"},{"identifier":"dataExtensions/2734db59-79a9-ed11-b866-48df376a1421","relationship":"required"},{"identifier":"dataExtensions/2634db59-79a9-ed11-b866-48df376a1421","relationship":"required"},{"identifier":"primaryLandingPages/929574-2129","relationship":"required"},{"identifier":"categories/398902","relationship":"required"}],"categories/398902":[],"primaryLandingPages/929574-2129":[{"identifier":"cloudPageCollections/1125","relationship":"required"},{"identifier":"categories/398902","relationship":"required"}],"primaryLandingPages/929575-2130":[{"identifier":"cloudPageCollections/1125","relationship":"required"},{"identifier":"categories/398902","relationship":"required"}]},"input":[{"key":"cloudPages-domain","type":"entityPicker","label":"FIELD_DEFINITION_CLOUDPAGES_DOMAIN","meta":{"entityType":"cloudpagesDomain"},"isSystem":true,"entities":["primaryLandingPages/929574-2129","primaryLandingPages/929575-2130"]}],"config":{"preserveCategories":true,"storeImagesAsReferences":false},"entities":{"assets":{},"attributeGroups":{},"attributeRelationships":{},"attributeSets":{},"automations":{"062a48b9-6e6b-436e-8789-0f4b18100d87":{"issues":[],"originID":"062a48b9-6e6b-436e-8789-0f4b18100d87","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"categoryId":"{{mcpm#/entities/categories/418749/data/id}}","description":"","name":"0800 FSP Flatten Subscriber Preferences","steps":[{"activities":[{"name":"{{mcpm#/entities/queryActivities/43d48268-07e3-4c31-be08-e60000f5edfa/data/name}}","activityObjectId":"{{mcpm#/entities/queryActivities/43d48268-07e3-4c31-be08-e60000f5edfa/data/id}}","objectTypeId":300,"displayOrder":0,"serializedObject":""}],"annotation":"","name":""},{"activities":[{"name":"{{mcpm#/entities/queryActivities/955881f4-6cb6-4ff3-917e-0e26af7f7c42/data/name}}","activityObjectId":"{{mcpm#/entities/queryActivities/955881f4-6cb6-4ff3-917e-0e26af7f7c42/data/id}}","objectTypeId":300,"displayOrder":0,"serializedObject":""}],"annotation":"","name":""},{"activities":[{"name":"{{mcpm#/entities/queryActivities/707c95b8-6dcc-4bc8-922b-2f86e3ac2ca6/data/name}}","activityObjectId":"{{mcpm#/entities/queryActivities/707c95b8-6dcc-4bc8-922b-2f86e3ac2ca6/data/id}}","objectTypeId":300,"displayOrder":0,"serializedObject":""}],"annotation":"","name":""},{"activities":[{"name":"{{mcpm#/entities/queryActivities/ef1dbe3f-9166-4c80-9cd4-b3f03dac00db/data/name}}","activityObjectId":"{{mcpm#/entities/queryActivities/ef1dbe3f-9166-4c80-9cd4-b3f03dac00db/data/id}}","objectTypeId":300,"displayOrder":0,"serializedObject":""}],"annotation":"","name":""}],"startSource":{"typeId":1}}}},"categories":{"398886":{"issues":[],"originID":"398886","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"description":"","categoryType":"dataextension","parentId":0,"name":"Data Extensions","editable":0,"extendable":1}},"398892":{"issues":[],"originID":"398892","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"description":"","categoryType":"queryactivity","parentId":0,"name":"Query","editable":0,"extendable":1}},"398897":{"issues":[],"originID":"398897","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"description":"","categoryType":"AUTOMATIONS","parentId":0,"name":"my automations","editable":0,"extendable":1}},"398902":{"issues":[],"originID":"398902","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"description":"The root folder for assets","categoryType":"asset","parentId":0,"name":"Content Builder","editable":0,"extendable":1}},"418405":{"issues":[],"originID":"418405","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"description":"","categoryType":"dataextension","parentId":"{{mcpm#/entities/categories/398886/data/id}}","name":"30_Custom Preference Center","editable":1,"extendable":1}},"418412":{"issues":[],"originID":"418412","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"description":"","categoryType":"queryactivity","parentId":"{{mcpm#/entities/categories/398892/data/id}}","name":"20_Automated","editable":1,"extendable":1}},"418426":{"issues":[],"originID":"418426","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"description":"","categoryType":"automations","parentId":"{{mcpm#/entities/categories/398897/data/id}}","name":"20_Automated","editable":1,"extendable":1}},"418436":{"issues":[],"originID":"418436","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"description":"","categoryType":"dataextension","parentId":"{{mcpm#/entities/categories/398886/data/id}}","name":"10_Core Data","editable":1,"extendable":1}},"418437":{"issues":[],"originID":"418437","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"description":"","categoryType":"dataextension","parentId":"{{mcpm#/entities/categories/418436/data/id}}","name":"Related Data Extensions","editable":1,"extendable":1}},"418749":{"issues":[],"originID":"418749","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"description":"","categoryType":"automations","parentId":"{{mcpm#/entities/categories/418426/data/id}}","name":"Preference Center","editable":1,"extendable":1}},"418750":{"issues":[],"originID":"418750","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"description":"","categoryType":"queryactivity","parentId":"{{mcpm#/entities/categories/418412/data/id}}","name":"Flatten Subscriber Preferences","editable":1,"extendable":1}}},"cloudPageCollections":{"1125":{"issues":[],"originID":"1125","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"name":"[CPC] Custom Preference Center"}}},"codeResources":{},"dataExtensions":{"2634db59-79a9-ed11-b866-48df376a1421":{"issues":[],"originID":"2634db59-79a9-ed11-b866-48df376a1421","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"categoryId":"{{mcpm#/entities/categories/418405/data/id}}","dataRetentionProperties":{"isDeleteAtEndOfRetentionPeriod":false,"isResetRetentionPeriodOnImport":false,"isRowBasedRetention":false,"rowBasedThreshold":100000000},"description":"","isFieldAdditionAllowed":true,"isFieldModificationAllowed":true,"isObjectDeletable":true,"isSendable":false,"isTestable":false,"name":"SubscriberPreferences","fields":[{"description":"","isHidden":false,"isInheritable":false,"isOverridable":false,"isNullable":false,"isPrimaryKey":true,"isReadOnly":false,"isTemplateField":false,"length":254,"masktype":"None","mustOverride":false,"name":"SubscriberKey","ordinal":0,"type":"Text"},{"description":"","isHidden":false,"isInheritable":false,"isOverridable":false,"isNullable":false,"isPrimaryKey":true,"isReadOnly":false,"isTemplateField":false,"length":100,"masktype":"None","mustOverride":false,"name":"Preference","ordinal":1,"type":"Text"},{"description":"","isHidden":false,"isInheritable":false,"isOverridable":false,"isNullable":true,"isPrimaryKey":false,"isReadOnly":false,"isTemplateField":false,"masktype":"None","mustOverride":false,"name":"OptinStatus","ordinal":2,"type":"Boolean"},{"description":"","isHidden":false,"isInheritable":false,"isOverridable":false,"isNullable":true,"isPrimaryKey":false,"isReadOnly":false,"isTemplateField":false,"masktype":"None","mustOverride":false,"name":"LastUpdatedDate","ordinal":3,"type":"Date"}]}},"2734db59-79a9-ed11-b866-48df376a1421":{"issues":[],"originID":"2734db59-79a9-ed11-b866-48df376a1421","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"categoryId":"{{mcpm#/entities/categories/418405/data/id}}","dataRetentionProperties":{"isDeleteAtEndOfRetentionPeriod":false,"isResetRetentionPeriodOnImport":false,"isRowBasedRetention":false,"rowBasedThreshold":100000000},"description":"","isFieldAdditionAllowed":true,"isFieldModificationAllowed":true,"isObjectDeletable":true,"isSendable":false,"isTestable":false,"name":"PreferenceCenter","fields":[{"description":"","isHidden":false,"isInheritable":false,"isOverridable":false,"isNullable":false,"isPrimaryKey":true,"isReadOnly":false,"isTemplateField":false,"length":100,"masktype":"None","mustOverride":false,"name":"PreferenceId","ordinal":0,"type":"Text"},{"description":"","isHidden":false,"isInheritable":false,"isOverridable":false,"isNullable":true,"isPrimaryKey":false,"isReadOnly":false,"isTemplateField":false,"length":100,"masktype":"None","mustOverride":false,"name":"PreferenceLabel","ordinal":1,"type":"Text"},{"description":"","isHidden":false,"isInheritable":false,"isOverridable":false,"isNullable":true,"isPrimaryKey":false,"isReadOnly":false,"isTemplateField":false,"length":400,"masktype":"None","mustOverride":false,"name":"PreferenceDescription","ordinal":2,"type":"Text"},{"description":"","isHidden":false,"isInheritable":false,"isOverridable":false,"isNullable":true,"isPrimaryKey":false,"isReadOnly":false,"isTemplateField":false,"masktype":"None","mustOverride":false,"name":"SortOrder","ordinal":3,"type":"Number"},{"description":"","isHidden":false,"isInheritable":false,"isOverridable":false,"isNullable":true,"isPrimaryKey":false,"isReadOnly":false,"isTemplateField":false,"masktype":"None","mustOverride":false,"name":"IsActive","ordinal":4,"type":"Boolean"}]}},"d3ebbe8a-9ea9-ed11-b866-48df376a1421":{"issues":[],"originID":"d3ebbe8a-9ea9-ed11-b866-48df376a1421","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"categoryId":"{{mcpm#/entities/categories/418437/data/id}}","dataRetentionProperties":{"isDeleteAtEndOfRetentionPeriod":false,"isResetRetentionPeriodOnImport":false,"isRowBasedRetention":false,"rowBasedThreshold":100000000},"description":"Subscription preferences","isFieldAdditionAllowed":true,"isFieldModificationAllowed":true,"isObjectDeletable":true,"isSendable":false,"isTestable":false,"name":"PF_Preference","fields":[{"description":"","isHidden":false,"isInheritable":true,"isOverridable":true,"isNullable":false,"isPrimaryKey":true,"isReadOnly":false,"isTemplateField":false,"length":255,"masktype":"None","mustOverride":false,"name":"PF_SubscriberKey","ordinal":0,"type":"Text"},{"description":"","isHidden":false,"isInheritable":true,"isOverridable":true,"isNullable":true,"isPrimaryKey":false,"isReadOnly":false,"isTemplateField":false,"masktype":"None","mustOverride":false,"name":"PF_Apples","ordinal":1,"type":"Boolean"},{"description":"","isHidden":false,"isInheritable":true,"isOverridable":true,"isNullable":true,"isPrimaryKey":false,"isReadOnly":false,"isTemplateField":false,"masktype":"None","mustOverride":false,"name":"PF_Oranges","ordinal":2,"type":"Boolean"},{"description":"","isHidden":false,"isInheritable":true,"isOverridable":true,"isNullable":true,"isPrimaryKey":false,"isReadOnly":false,"isTemplateField":false,"masktype":"None","mustOverride":false,"name":"PF_Grapes","ordinal":3,"type":"Boolean"}]}}},"dataExtractActivities":{},"dataFilterDefinitions":{},"dataFilters":{},"eventDefinitions":{},"fileTransferActivities":{},"importActivities":{},"journeys":{},"journeyTemplates":{},"landingPages":{"929574-2129":{"issues":[{"type":"UNSUPPORTED_AMPSCRIPT","level":"INFO","sourceJobType":"PACKAGE","issue":"UNRESOLVED_VARIABLE"}],"originID":"929574-2129","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"asset":{"assetType":{"id":205,"name":"webpage"},"name":"CPC_Handler","category":{"id":"{{mcpm#/entities/categories/398902/data/id}}"},"contentType":"text/html","meta":{"globalStyles":{"isLocked":false,"body":{"max-width":"1280px"}}},"views":{"html":{"thumbnail":{},"content":"<!DOCTYPE html>\n<html>\n<head>\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n\t<style class=\"main_style\">\n.layout-canvas-g {\n  background-color: #fff;\n  border: none;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  padding: 0;\n  width: 100%;\n}\n.layout-canvas-g > .header,\n.layout-canvas-g > .section,\n.layout-canvas-g > .footer {\n  position: relative;\n  overflow: hidden;\n  width: 100%;\n  word-wrap: break-word;\n}\n.layout-canvas-g > .section {\n  margin: 10px 0;\n}\n.layout-canvas-g > .section > .columns {\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  word-wrap: break-word;\n}\nbody {\n  color: #000;\n  font-family: Arial;\n  font-size: 12px;\n  margin: 0 auto;\n  max-width: 1280px;\n}\n@media only screen and (max-width: 480px) {\n  .mobile-hidden {\n    display: none !important;\n  }\n  .responsive-td {\n    width: 100% !important;\n    display: block !important;\n    padding: 0 !important;\n  }\n}\n.layout-canvas-g > .section > .columns {\n  width: 100%;\n}\n\n</style>\n\n</head>\n<body>\n<div class=\"layout layout-canvas-g\">\n\t<div class=\"section\">\n\t\t<div class=\"columns col1\">\n\t\t\t<div data-type=\"slot\" data-key=\"col1\"></div>\n\t\t</div>\n\t</div>\n</div>\n</body>\n</html>\n","meta":{},"slots":{"col1":{"content":"<div data-type=\"block\" data-key=\"0nelopei5hpe\"></div>","design":"<p style=\"font-family:arial;color:#ccc;font-size:11px;text-align:center;vertical-align:middle;font-weight:bold;padding:10px;margin:0;border:#ccc dashed 1px;\">Drop blocks or content here</p>","blocks":{"0nelopei5hpe":{"assetType":{"id":220,"name":"codesnippetblock"},"content":"%%[\nSET @versionControl = 1.1\nSET @debug = \"\"\n\n/* STATUS FLAGS */\nSET @UNSUBBED = 1\nSET @STATUS_FLAG = 0\nSET @ERROR_NOSUB = -1\n\n/* GLOBAL FIELD NAMES */\nSET @unsubscribeName = \"unsubscribe\"\nSET @resubscribeName = \"resubscribe\"\nSET @overrideResubscribe = \"optin\"\nSET @overrideUnsubscribe = \"optout\"\nVAR @override\nSET @override = \"0\"\n\n/* Get and check for the subscriber key */\nSET @subscriberKey = RequestParameter(\"subkey\")\n/* Error out if we dont have a subscriber key */\nIF EMPTY(@subscriberKey) THEN\n  SET @STATUS_FLAG = @ERROR_NOSUB\nENDIF\n\n/* ----------------- Net New Subscriber Auto Preference Opt-in -----------------------*/\n\n/* Get all the preferences for this specific subscriber*/\nSET @subsPreferenceRows = LookupRows(\"{{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/name}}\", \"SubscriberKey\", @subscriberKey)\nSET @subPreferenceCount = ROWCOUNT(@subsPreferenceRows)\n\nIF @subPreferenceCount == 0 THEN\n  SET @preferenceRows = LookupOrderedRows(\"{{mcpm#/entities/dataExtensions/2734db59-79a9-ed11-b866-48df376a1421/data/name}}\", 0, \"SortOrder ASC\", \"IsActive\", \"True\")\n  SET @preferenceCount = ROWCOUNT(@preferenceRows)\n  FOR @i = 1 TO @preferenceCount DO\n      SET @prefCurrRow = ROW(@preferenceRows, @i)\n      SET @preferenceId = FIELD(@prefCurrRow, \"PreferenceId\")\n      InsertData(\"{{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/name}}\", \"SubscriberKey\", @subscriberKey, \"Preference\", @preferenceId, \"OptinStatus\", \"TRUE\",\"LastUpdatedDate\", Now())\n  NEXT\n  Redirect(CloudPagesURL(2117,\"thankyou\",\"0\",\"subkey\",@subscriberKey))\nENDIF\n\n/* ----------------- Complete global unsubscribes -----------------------*/\nSET @unsubscribe = RequestParameter(@unsubscribeName)\nIF NOT EMPTY(@unsubscribe) THEN\n\n SET @debug = Concat(@debug,@unsubscribe)\n \n    SET @override = @overrideUnsubscribe\n\n    /* Unsubscribe from all subscribers */\n    SET @jid = JobID\n    SET @listid = ListID\n    SET @batchid = _JobSubscriberBatchID\n    SET @reason = \"Landing Page Unsubscribe\"\n\n    SET @lue = CreateObject(\"ExecuteRequest\")\n    SetObjectProperty(@lue,\"Name\",\"LogUnsubEvent\")\n\n    SET @lue_prop = CreateObject(\"APIProperty\")                 \n    SetObjectProperty(@lue_prop, \"Name\", \"SubscriberKey\")\n    SetObjectProperty(@lue_prop, \"Value\", @subscriberKey)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"JobID\")\n    SetObjectProperty(@lue_prop, \"Value\", @jid)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"ListID\")\n    SetObjectProperty(@lue_prop, \"Value\", @listid)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"BatchID\")\n    SetObjectProperty(@lue_prop, \"Value\", @batchid)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"Reason\")\n    SetObjectProperty(@lue_prop, \"Value\", @reason)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_statusCode = InvokeExecute(@lue, @overallStatus, @requestId)\n\n    SET @lue_Response = Row(@lue_statusCode, 1)\n    SET @lue_Status = Field(@lue_Response,\"StatusMessage\")\n    SET @lue_Error = Field(@lue_Response,\"ErrorCode\")\n\n    SET @debug = Concat(@debug,Concat(\" - Unsubbing subscriber from all subs: \",@subscriberKey, @lue_Status))\n \nENDIF\n/* ----------------- End of global unsubscribes -----------------------*/\n\n/* ----------------- Start of resubscribe -----------------------*/\nSET @resubscribe = RequestParameter(@resubscribeName)\nIF NOT EMPTY(@resubscribe) THEN\n\n  SET @override = @overrideResubscribe\n  SET @sub = CreateObject(\"Subscriber\")\n  SetObjectProperty(@sub, \"SubscriberKey\", @subscriberKey)\n  SetObjectProperty(@sub, \"Status\", \"Active\")\n  SET @updateStatusCode = InvokeUpdate(@sub, @updateStatusMessage, @updateErrorCode, @updateOptions)\n  SET @debug = Concat(@debug,Concat(\" - resubbing subscriber from all subs: \",@subscriberKey, @updateStatusCode))\n\nENDIF\n/* ----------------- End of resubscribe -----------------------*/\n\n/* ----------------- Start of program specific changes -----------------------*/\n/* On Unsub = Opt out of everything, Resub = Opt into everything\n   else = Opt into/outof whatever is in the payload              */\n   \nSET @rows = LookupRows(\"{{mcpm#/entities/dataExtensions/2734db59-79a9-ed11-b866-48df376a1421/data/name}}\",\"IsActive\", \"True\")\n\nFOR @counter = 1 TO ROWCOUNT(@rows) DO\n\n  SET @currentRow = row(@rows, @counter)\n\n  /* Get the current program */\n  SET @progName = field(@currentRow, \"PreferenceId\")\n\n  /* Check if an override is set, if not then request parameter from payload*/\n  IF @override == @overrideResubscribe THEN\n    SET @progOptIn = \"true\"\n  ELSEIF @override == @overrideUnsubscribe THEN\n    SET @progOptIn = \"\"\n  ELSE\n    SET @progOptIn = RequestParameter(@progName)\n  ENDIF\n\n  IF NOT EMPTY(@progOptIn) THEN\n   /* The current row matches a program they want to subscribe into */\n    UpsertData(\"{{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/name}}\",2,\"SubscriberKey\", @subscriberKey, \"Preference\", @progName, \"OptinStatus\", \"True\", \"LastUpdatedDate\", NOW())\n    SET @debug = Concat(@debug,Concat(\" - Subbing \",@subscriberKey, \" into program \",@progName))\n  ELSE\n     /* The current row doesnt match a program they want to subscribe into - therefor they are unsubbed from it */\n    UpsertData(\"{{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/name}}\",2,\"SubscriberKey\", @subscriberKey, \"Preference\", @progName, \"OptinStatus\", \"False\", \"LastUpdatedDate\", NOW())\n    SET @debug = Concat(@debug,Concat(\" - Unsubbing \",@subscriberKey, \" from program \",@progName))\n  ENDIF\n\nNEXT\n/* ----------------- End of program specific changes -----------------------*/\n ]%%\n\n%%[Redirect(CloudPagesURL(2117,\"thankyou\",\"1\",\"subkey\",@subscriberKey))]%%","design":"<div class=\"default-design\"><div style=\"width:100%;height:150px;background: url(data:image/png;base64,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) repeat-x 0 0\"></div></div>","meta":{},"modelVersion":2}},"modelVersion":2}},"modelVersion":2}}},"content":{"channelTypeId":3,"contentType":"text/html","html":"<!DOCTYPE html>\n<html>\n<head>\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n\t<style class=\"main_style\">\n.layout-canvas-g {\n  background-color: #fff;\n  border: none;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  padding: 0;\n  width: 100%;\n}\n.layout-canvas-g > .header,\n.layout-canvas-g > .section,\n.layout-canvas-g > .footer {\n  position: relative;\n  overflow: hidden;\n  width: 100%;\n  word-wrap: break-word;\n}\n.layout-canvas-g > .section {\n  margin: 10px 0;\n}\n.layout-canvas-g > .section > .columns {\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  word-wrap: break-word;\n}\nbody {\n  color: #000;\n  font-family: Arial;\n  font-size: 12px;\n  margin: 0 auto;\n  max-width: 1280px;\n}\n@media only screen and (max-width: 480px) {\n  .mobile-hidden {\n    display: none !important;\n  }\n  .responsive-td {\n    width: 100% !important;\n    display: block !important;\n    padding: 0 !important;\n  }\n}\n.layout-canvas-g > .section > .columns {\n  width: 100%;\n}\n\n</style>\n\n</head>\n<body>\n<div class=\"layout layout-canvas-g\">\n\t<div class=\"section\">\n\t\t<div class=\"columns col1\">\n\t\t\t%%[\nSET @versionControl = 1.1\nSET @debug = \"\"\n\n/* STATUS FLAGS */\nSET @UNSUBBED = 1\nSET @STATUS_FLAG = 0\nSET @ERROR_NOSUB = -1\n\n/* GLOBAL FIELD NAMES */\nSET @unsubscribeName = \"unsubscribe\"\nSET @resubscribeName = \"resubscribe\"\nSET @overrideResubscribe = \"optin\"\nSET @overrideUnsubscribe = \"optout\"\nVAR @override\nSET @override = \"0\"\n\n/* Get and check for the subscriber key */\nSET @subscriberKey = RequestParameter(\"subkey\")\n/* Error out if we dont have a subscriber key */\nIF EMPTY(@subscriberKey) THEN\n  SET @STATUS_FLAG = @ERROR_NOSUB\nENDIF\n\n/* ----------------- Net New Subscriber Auto Preference Opt-in -----------------------*/\n\n/* Get all the preferences for this specific subscriber*/\nSET @subsPreferenceRows = LookupRows(\"SubscriberPreferences\", \"SubscriberKey\", @subscriberKey)\nSET @subPreferenceCount = ROWCOUNT(@subsPreferenceRows)\n\nIF @subPreferenceCount == 0 THEN\n  SET @preferenceRows = LookupOrderedRows(\"PreferenceCenter\", 0, \"SortOrder ASC\", \"IsActive\", \"True\")\n  SET @preferenceCount = ROWCOUNT(@preferenceRows)\n  FOR @i = 1 TO @preferenceCount DO\n      SET @prefCurrRow = ROW(@preferenceRows, @i)\n      SET @preferenceId = FIELD(@prefCurrRow, \"PreferenceId\")\n      InsertData(\"SubscriberPreferences\", \"SubscriberKey\", @subscriberKey, \"Preference\", @preferenceId, \"OptinStatus\", \"TRUE\",\"LastUpdatedDate\", Now())\n  NEXT\n  Redirect(CloudPagesURL(2117,\"thankyou\",\"0\",\"subkey\",@subscriberKey))\nENDIF\n\n/* ----------------- Complete global unsubscribes -----------------------*/\nSET @unsubscribe = RequestParameter(@unsubscribeName)\nIF NOT EMPTY(@unsubscribe) THEN\n\n SET @debug = Concat(@debug,@unsubscribe)\n \n    SET @override = @overrideUnsubscribe\n\n    /* Unsubscribe from all subscribers */\n    SET @jid = JobID\n    SET @listid = ListID\n    SET @batchid = _JobSubscriberBatchID\n    SET @reason = \"Landing Page Unsubscribe\"\n\n    SET @lue = CreateObject(\"ExecuteRequest\")\n    SetObjectProperty(@lue,\"Name\",\"LogUnsubEvent\")\n\n    SET @lue_prop = CreateObject(\"APIProperty\")                 \n    SetObjectProperty(@lue_prop, \"Name\", \"SubscriberKey\")\n    SetObjectProperty(@lue_prop, \"Value\", @subscriberKey)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"JobID\")\n    SetObjectProperty(@lue_prop, \"Value\", @jid)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"ListID\")\n    SetObjectProperty(@lue_prop, \"Value\", @listid)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"BatchID\")\n    SetObjectProperty(@lue_prop, \"Value\", @batchid)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"Reason\")\n    SetObjectProperty(@lue_prop, \"Value\", @reason)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_statusCode = InvokeExecute(@lue, @overallStatus, @requestId)\n\n    SET @lue_Response = Row(@lue_statusCode, 1)\n    SET @lue_Status = Field(@lue_Response,\"StatusMessage\")\n    SET @lue_Error = Field(@lue_Response,\"ErrorCode\")\n\n    SET @debug = Concat(@debug,Concat(\" - Unsubbing subscriber from all subs: \",@subscriberKey, @lue_Status))\n \nENDIF\n/* ----------------- End of global unsubscribes -----------------------*/\n\n/* ----------------- Start of resubscribe -----------------------*/\nSET @resubscribe = RequestParameter(@resubscribeName)\nIF NOT EMPTY(@resubscribe) THEN\n\n  SET @override = @overrideResubscribe\n  SET @sub = CreateObject(\"Subscriber\")\n  SetObjectProperty(@sub, \"SubscriberKey\", @subscriberKey)\n  SetObjectProperty(@sub, \"Status\", \"Active\")\n  SET @updateStatusCode = InvokeUpdate(@sub, @updateStatusMessage, @updateErrorCode, @updateOptions)\n  SET @debug = Concat(@debug,Concat(\" - resubbing subscriber from all subs: \",@subscriberKey, @updateStatusCode))\n\nENDIF\n/* ----------------- End of resubscribe -----------------------*/\n\n/* ----------------- Start of program specific changes -----------------------*/\n/* On Unsub = Opt out of everything, Resub = Opt into everything\n   else = Opt into/outof whatever is in the payload              */\n   \nSET @rows = LookupRows(\"PreferenceCenter\",\"IsActive\", \"True\")\n\nFOR @counter = 1 TO ROWCOUNT(@rows) DO\n\n  SET @currentRow = row(@rows, @counter)\n\n  /* Get the current program */\n  SET @progName = field(@currentRow, \"PreferenceId\")\n\n  /* Check if an override is set, if not then request parameter from payload*/\n  IF @override == @overrideResubscribe THEN\n    SET @progOptIn = \"true\"\n  ELSEIF @override == @overrideUnsubscribe THEN\n    SET @progOptIn = \"\"\n  ELSE\n    SET @progOptIn = RequestParameter(@progName)\n  ENDIF\n\n  IF NOT EMPTY(@progOptIn) THEN\n   /* The current row matches a program they want to subscribe into */\n    UpsertData(\"SubscriberPreferences\",2,\"SubscriberKey\", @subscriberKey, \"Preference\", @progName, \"OptinStatus\", \"True\", \"LastUpdatedDate\", NOW())\n    SET @debug = Concat(@debug,Concat(\" - Subbing \",@subscriberKey, \" into program \",@progName))\n  ELSE\n     /* The current row doesnt match a program they want to subscribe into - therefor they are unsubbed from it */\n    UpsertData(\"SubscriberPreferences\",2,\"SubscriberKey\", @subscriberKey, \"Preference\", @progName, \"OptinStatus\", \"False\", \"LastUpdatedDate\", NOW())\n    SET @debug = Concat(@debug,Concat(\" - Unsubbing \",@subscriberKey, \" from program \",@progName))\n  ENDIF\n\nNEXT\n/* ----------------- End of program specific changes -----------------------*/\n ]%%\n\n%%[Redirect(CloudPagesURL(2117,\"thankyou\",\"1\",\"subkey\",@subscriberKey))]%%\n\t\t</div>\n\t</div>\n</div>\n</body>\n</html>\n","isDefault":true,"isStaticContent":false,"name":"CPC_Handler","siteId":"{{mcpm#/entities/primaryLandingPages/929574-2129/data/definition/landingPageId}}"},"name":"cpc_handler","primaryId":"{{mcpm#/entities/primaryLandingPages/929574-2129/data/id}}","state":{"contentType":"text/html","description":"","name":"cpc_handler","siteId":"{{mcpm#/entities/primaryLandingPages/929574-2129/data/definition/landingPageId}}"}}},"929575-2130":{"issues":[{"type":"UNSUPPORTED_AMPSCRIPT","level":"INFO","sourceJobType":"PACKAGE","issue":"UNRESOLVED_VARIABLE"}],"originID":"929575-2130","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"asset":{"assetType":{"id":205,"name":"webpage"},"name":"CPC_Main","category":{"id":"{{mcpm#/entities/categories/398902/data/id}}"},"contentType":"text/html","meta":{"globalStyles":{"isLocked":false,"body":{"max-width":"1280px"}}},"views":{"html":{"thumbnail":{},"content":"<!DOCTYPE html>\n<html>\n<head>\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n\t<style class=\"main_style\">\n.layout-canvas-g {\n  background-color: #fff;\n  border: none;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  padding: 0;\n  width: 100%;\n}\n.layout-canvas-g > .header,\n.layout-canvas-g > .section,\n.layout-canvas-g > .footer {\n  position: relative;\n  overflow: hidden;\n  width: 100%;\n  word-wrap: break-word;\n}\n.layout-canvas-g > .section {\n  margin: 10px 0;\n}\n.layout-canvas-g > .section > .columns {\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  word-wrap: break-word;\n}\nbody {\n  color: #000;\n  font-family: Arial;\n  font-size: 12px;\n  margin: 0 auto;\n  max-width: 1280px;\n}\n@media only screen and (max-width: 480px) {\n  .mobile-hidden {\n    display: none !important;\n  }\n  .responsive-td {\n    width: 100% !important;\n    display: block !important;\n    padding: 0 !important;\n  }\n}\n.layout-canvas-g > .section > .columns {\n  width: 100%;\n}\n\n</style>\n\n</head>\n<body>\n<div class=\"layout layout-canvas-g\">\n\t<div class=\"section\">\n\t\t<div class=\"columns col1\">\n\t\t\t<div data-type=\"slot\" data-key=\"col1\"></div>\n\t\t</div>\n\t</div>\n</div>\n</body>\n</html>\n","meta":{},"slots":{"col1":{"content":"<div data-type=\"block\" data-key=\"1wsz97pdf3n\"></div>","design":"<p style=\"font-family:arial;color:#ccc;font-size:11px;text-align:center;vertical-align:middle;font-weight:bold;padding:10px;margin:0;border:#ccc dashed 1px;\">Drop blocks or content here</p>","blocks":{"1wsz97pdf3n":{"assetType":{"id":220,"name":"codesnippetblock"},"content":"<div style=\"display:none;\">\n%%[\n    SET @versionControl = \"1.0\"\n    /* STILL HAVE TO COMPLETE NEW ARRIVAL BEHAVIOR */\n\n    /* STATUS FLAGS */\n    SET @STATUS = 0\n    SET @UNSUBBED_FLAG = 1\n    SET @THANKS_FLAG = 2\n    \n    SET @ERROR_NOSUB = -1\n    SET @ERROR_NOEMAIL = -2\n    SET @ERROR_NOSUBFOUND = -4 /* No sub in all subscribers */\n    SET @errorMessage = \"\"\n\n    \n    SET @STATUS_PARAM = RequestParameter(\"thankyou\")\n    IF @STATUS_PARAM == \"1\" THEN\n      SET @STATUS= @THANKS_FLAG\n    ENDIF\n    /* END OF STATUS FLAGS */\n\n\n    /* Get and check for the subscriber key */\n    SET @subscriberKey = RequestParameter(\"subkey\")\n    /* SET @subscriberKey = AttributeValue(\"_subscriberKey\") */\n    /* Error out if we dont have a subscriber key */\n    IF EMPTY(@SubscriberKey) THEN\n      SET @STATUS = @ERROR_NOSUB\n      SET @errorMessage = \"No subscriber key found.\"\n    ENDIF\n\n    /* Get and check for the email address */\n    IF @STATUS >= 0 THEN   \n      \n     /* Get the current subscribers subscriber object, and check their subscription status */\n      SET @currSubRequest=CreateObject(\"RetrieveRequest\")\n      SetObjectProperty(@currSubRequest,\"ObjectType\",\"Subscriber\")\n      AddObjectArrayItem(@currSubRequest,\"Properties\",\"SubscriberKey\")\n      AddObjectArrayItem(@currSubRequest,\"Properties\",\"Status\")\n      AddObjectArrayItem(@currSubRequest,\"Properties\",\"EmailAddress\")\n\n      SET @sfp=CreateObject(\"SimpleFilterPart\")\n      SetObjectProperty(@sfp,\"Property\",\"SubscriberKey\")\n      SetObjectProperty(@sfp,\"SimpleOperator\",\"equals\")\n      AddObjectArrayItem(@sfp,\"Value\",@subscriberKey)\n      SetObjectProperty(@currSubRequest,\"Filter\",@sfp)\n\n      SET @sub=InvokeRetrieve(@currSubRequest, @reqStatus)\n      IF RowCount(@sub) > 0 THEN /*Subscriber found */\n        SET @subfield = Row(@sub, 1)\n        SET @activityStatus = Field(@subfield, \"Status\")\n        SET @emailAddress = Field(@subfield, \"EmailAddress\")\n        \n        /* Determine if the subscriber is subscribed or not */\n        IF @activityStatus != \"Active\" THEN /*Subscriber is unsubscribed*/\n          SET @STATUS = @UNSUBBED_FLAG\n        ENDIF\n\n        /* Error out if we dont have an email address */\n        IF EMPTY(@emailAddress) THEN\n          SET @STATUS = @ERROR_NOEMAIL\n          SET @errorMessage = CONCAT(\"No email found for subscriber \",@subscriberKey,\".\")\n        ENDIF\n\n      ELSE/* Subscriber not found */\n        SET @STATUS = @ERROR_NOSUBFOUND\n        SET @errorMessage = CONCAT(\"No subscriber found in All Subscribers with current subscriber key \",@subscriberKey,\".\")\n      ENDIF\n\n    ENDIF\n]%%\n</div>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n    <link href=\"https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700\" rel=\"stylesheet\">\n\n    <style>\n      \n      \n      html, body {\n  height: 100%;\n}\n\n.toggle {\n  position: relative;\n  display: block;\n  width: 40px;\n  height: 20px;\n  cursor: pointer;\n  -webkit-tap-highlight-color: transparent;\n  transform: translate3d(0, 0, 0);\n}\n.toggle:before {\n  content: \"\";\n  position: relative;\n  top: 3px;\n  left: 3px;\n  width: 34px;\n  height: 14px;\n  display: block;\n  background: #9A9999;\n  border-radius: 8px;\n  transition: background 0.2s ease;\n}\n.toggle span {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 20px;\n  height: 20px;\n  display: block;\n  background: white;\n  border-radius: 10px;\n  box-shadow: 0 3px 8px rgba(154, 153, 153, 0.5);\n  transition: all 0.2s ease;\n}\n.toggle span:before {\n  content: \"\";\n  position: absolute;\n  display: block;\n  margin: -18px;\n  width: 56px;\n  height: 56px;\n  background: rgba(79, 46, 220, 0.5);\n  border-radius: 50%;\n  transform: scale(0);\n  opacity: 1;\n  pointer-events: none;\n}\n\n.cbx:checked + .toggle:before {\n  background: #5d8fda;\n}\n.cbx:checked + .toggle span {\n  background: #24559e;\n  transform: translateX(20px);\n  transition: all 0.2s cubic-bezier(0.8, 0.4, 0.3, 1.25), background 0.15s ease;\n  box-shadow: 0 3px 8px rgba(79, 46, 220, 0.2);\n}\n.cbx:checked + .toggle span:before {\n  transform: scale(1);\n  opacity: 0;\n  transition: all 0.4s ease;\n}\n\n.center {\n  position: absolute;\n  top: calc(50% - 10px);\n  left: calc(50% - 20px);\n}\n      \n      \n      \n      \n      * {\n         font-family: 'Montserrat', sans-serif;\n\n      }\n      h1 {\n        font-size: 42px;\n        font-weight: 600;\n        margin: 0px 0px;\n\n      }\n\n      h2 {\n        font-size: 28px;\n        font-weight: 600;\n        margin: 0px 0px;\n\n      }\n\n      h3 {\n        font-size: 22px;\n        font-weight: 600;\n        margin: 0px 0px;\n\n      }\n      .main-outer {\n        color: #000;\n        font-family: 'Montserrat', sans-serif;\n        font-size: 15px;\n        margin: 0 auto;\n        padding-bottom: 10px;\n        max-width: 1080px; \n      }\n      \n      .main-inner {\n        margin: 50px 20px 0px 20px;\n        \n      }\n      \n      .email-display {\n        text-align:left;\n        border: solid 1px grey; \n        border-radius:8px;\n        padding:0px 10px;\n        width: 450px\n      }\n      \n      .submit-button {\n        background-color: #2659a6;\n        border: none;\n        text-transform: uppercase;\n        border-radius: 20px;\n        text-align: center;\n        padding: 13px 27px;\n        color: white;\n        font-size: 16px;\n        font-weight: 600;\n      }\n      \n      .submit-button:hover {\n        background-color: #3372d1;\n        padding: 14px 29px;\n      }\n      p {\n       color: #808080; \n        margin: 10px 0px;\n\n      }\n      \n      .preference-box-ind {\n        display: inline-block; \n        width:90%; \n        vertical-align: middle;\n        \n      }\n\n      @media only screen and (max-width: 500px) {\n          .mobile-hidden {\n            display: none !important;\n          }\n\n          .email-display {\n            width: 300px; \n\n          }\n\n          .preference-box-ind {\n            width:80%;\n          }\n\n         h1 {\n          font-size: 36px;\n          font-weight: 600;\n          margin: 0px 0px;\n\n        }\n\n        h2 {\n          font-size: 24px;\n          font-weight: 600;\n          margin: 0px 0px;\n\n        }\n\n        h3 {\n          font-size: 20px;\n          font-weight: 600;\n          margin: 0px 0px;\n\n        }\n\n        .submit-button:hover {\n          padding: 14px 29px;\n        }\n\n        }\n      }\n\n    </style>\n  </head>\n\n  <body>\n    <div class=\"main-outer\">\n      <img style=\"width:100%; display:inline;\" src=\"https://via.placeholder.com/1796x933/808080/FFFFFF%20?text=PlaceholderHero\" alt=\"Header\">\n      \n      <div class=\"main-inner\">\n        <h1>\n          Email Preferences\n        </h1>\n        <p>\n          We don't like SPAM either.<br>Choose what you want to hear about below.\n        </p>\n        <br>\n        \n        %%[\n            IF @STATUS == @THANKS_FLAG THEN\n            SET @subscriberKey = RequestParameter(\"subkey\")\n           ]%%\n        <h3>\n          Thank you, your preferences have been updated.\n        </h3>\n\n        <br><br>\n        <form method=\"post\" action=\"%%=CloudPagesURL(\"{{mcpm#/entities/primaryLandingPages/929575-2130/data/definition/pageId}}\",\"subkey\",@subscriberKey)=%%\">\n            <input type=\"submit\" value=\"Back to Preferences\" class=\"submit-button\">\n        </form>\n\n        %%[\n            ELSEIF @STATUS < 0 THEN\n          ]%%\n        <h3>\n          An error has occured: %%=v(@errorMessage)=%%<br>Please try again later.\n        </h3>\n        %%[\n          ELSE\n          ]%%\n        \n        <div class=\"email-display\">\n\n          <div style=\"display: inline-block; vertical-align: middle;\">\n            <img style=\"width:40px; display:inline;\" src=\"https://e7.pngegg.com/pngimages/522/873/png-clipart-black-envelope-icon-advanced-case-management-envelope-computer-icons-icon-design-envelope-mail-miscellaneous-angle.png\" alt=\"Email:\">\n          </div>\n          \n          <div style=\"display: inline-block; padding-left: 10px;  vertical-align: middle;\">\n            <p style=\"color:#b8b8b8;font-size:14px\">\n              %%=v(@emailAddress)=%%\n            </p>\n          </div>\n        </div> <!-- email display -->\n        <br><br>\n\n        \n        \n        <form method=\"post\" action=\"%%=CloudPagesURL(\"{{mcpm#/entities/primaryLandingPages/929574-2129/data/definition/pageId}}\",\"subkey\",@subscriberKey)=%%\">\n          %%[\n              IF @STATUS == @UNSUBBED_FLAG THEN\n            ]%%\n          <hr><br>\n          <div class=\"preference-box-ind\">\n            <p id=\"paragraph\">If you would like to resubscribe into our marketing and promotional emails, please check the box then click \"Update Preferences.\"</p>\n          </div>\n          \n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" name=\"resubscribe\" id=\"cbxresubscribe\" style=\"display:none\"/>\n            <label for=\"cbxresubscribe\" class=\"toggle\"><span></span></label>\n          </div>\n         <br><br><hr>\n          \n          <br><br>\n          <input type=\"Submit\" value=\"Update Preferences\" class=\"submit-button\">\n          %%[\n           ELSE\n\n                  /* Get all the preferences in this BU from the DE SubscriberPreferences*/\n                  SET @preferenceRows = LookupOrderedRows(\"{{mcpm#/entities/dataExtensions/2734db59-79a9-ed11-b866-48df376a1421/data/name}}\", 0, \"SortOrder ASC\", \"IsActive\", \"True\")\n                  SET @preferenceCount = ROWCOUNT(@preferenceRows)\n\n                  /* Get all the preferences for this specific subscriber*/\n                  SET @subsPreferenceRows = LookupRows(\"{{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/name}}\", \"SubscriberKey\", @subscriberKey)\n                  SET @subPreferenceCount = ROWCOUNT(@subsPreferenceRows)\n\n                  SET @override = false\n                  IF @subPreferenceCount == 0 THEN\n                    Redirect(CloudPagesURL(2116,\"subkey\",@subscriberKey))/* Not updated yet, try again.*/\n                  ENDIF\n\n                  IF @preferenceCount != 0 THEN \n                      SET @subsPrefs = ROW(@subsPreferenceRows, 1)\n\n                      FOR @i = 1 TO @preferenceCount DO\n                          SET @prefCurrRow = ROW(@preferenceRows, @i)\n\n                          SET @preferenceId = FIELD(@prefCurrRow, \"PreferenceId\")\n                          SET @label = FIELD(@prefCurrRow, \"PreferenceLabel\")\n                          SET @description = FIELD(@prefCurrRow, \"PreferenceDescription\")\n\n\n                          SET @subOptInValue = Lookup(\"{{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/name}}\", \"OptinStatus\", \"SubscriberKey\", @subscriberKey,\"Preference\",@preferenceId)\n\n              ]%%\n          <div class=\"preference-box-ind\">\n            <h3>\n              %%=v(@label)=%%\n            </h3>\n            <p class=\"description\" >\n              %%=v(@description)=%%\n            </p> \n          </div>\n\n          %%[IF @subOptInValue == \"True\" THEN]%%\n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" name=\"%%=v(@preferenceId)=%%\" checked id=\"cbx%%=v(@preferenceId)=%%\" style=\"display:none\"/>\n            <label for=\"cbx%%=v(@preferenceId)=%%\" class=\"toggle\"><span></span></label>\n          </div>\n          %%[ELSE]%%\n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" name=\"%%=v(@preferenceId)=%%\" id=\"cbx%%=v(@preferenceId)=%%\" style=\"display:none\"/>\n            <label for=\"cbx%%=v(@preferenceId)=%%\" class=\"toggle\"><span></span></label>\n          </div>\n          %%[ENDIF]%%\n           <br><br>\n\n          \n          %%[ \n              NEXT \n             ENDIF /* ENDIF for preferences check*/\n            ]%%\n          \n          <hr><br>\n          <div class=\"preference-box-ind\">\n            <h3>\n             Opt out of all [COMPANY NAME] Communications\n            </h3>\n          </div>\n\n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" id=\"cbxunsub\" name=\"unsubscribe\" style=\"display:none\"/>\n            <label for=\"cbxunsub\" class=\"toggle\"><span></span></label>    \n          </div>\n          <br><br><hr>\n          \n          <br><br>\n          <input type=\"Submit\" value=\"Update Preferences\" class=\"submit-button\">\n          %%[ \n          ENDIF /* ENDIF for \"IF @STATUS == @UNSUBBED_FLAG THEN\" block*/\n         ENDIF /* ENDIF for \"IF @STATUS == @THANKS_FLAG THEN\" block*/\n         ]%%\n\n        </form>\n      </div>\n    </div>\n  </body>\n</html>\n","design":"<div class=\"default-design\"><div style=\"width:100%;height:150px;background: url(data:image/png;base64,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) repeat-x 0 0\"></div></div>","meta":{},"modelVersion":2}},"modelVersion":2}},"modelVersion":2}}},"content":{"channelTypeId":3,"contentType":"text/html","html":"<!DOCTYPE html>\n<html>\n<head>\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n\t<style class=\"main_style\">\n.layout-canvas-g {\n  background-color: #fff;\n  border: none;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  padding: 0;\n  width: 100%;\n}\n.layout-canvas-g > .header,\n.layout-canvas-g > .section,\n.layout-canvas-g > .footer {\n  position: relative;\n  overflow: hidden;\n  width: 100%;\n  word-wrap: break-word;\n}\n.layout-canvas-g > .section {\n  margin: 10px 0;\n}\n.layout-canvas-g > .section > .columns {\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  word-wrap: break-word;\n}\nbody {\n  color: #000;\n  font-family: Arial;\n  font-size: 12px;\n  margin: 0 auto;\n  max-width: 1280px;\n}\n@media only screen and (max-width: 480px) {\n  .mobile-hidden {\n    display: none !important;\n  }\n  .responsive-td {\n    width: 100% !important;\n    display: block !important;\n    padding: 0 !important;\n  }\n}\n.layout-canvas-g > .section > .columns {\n  width: 100%;\n}\n\n</style>\n\n</head>\n<body>\n<div class=\"layout layout-canvas-g\">\n\t<div class=\"section\">\n\t\t<div class=\"columns col1\">\n\t\t\t<div style=\"display:none;\">\n%%[\n    SET @versionControl = \"1.0\"\n    /* STILL HAVE TO COMPLETE NEW ARRIVAL BEHAVIOR */\n\n    /* STATUS FLAGS */\n    SET @STATUS = 0\n    SET @UNSUBBED_FLAG = 1\n    SET @THANKS_FLAG = 2\n    \n    SET @ERROR_NOSUB = -1\n    SET @ERROR_NOEMAIL = -2\n    SET @ERROR_NOSUBFOUND = -4 /* No sub in all subscribers */\n    SET @errorMessage = \"\"\n\n    \n    SET @STATUS_PARAM = RequestParameter(\"thankyou\")\n    IF @STATUS_PARAM == \"1\" THEN\n      SET @STATUS= @THANKS_FLAG\n    ENDIF\n    /* END OF STATUS FLAGS */\n\n\n    /* Get and check for the subscriber key */\n    SET @subscriberKey = RequestParameter(\"subkey\")\n    /* SET @subscriberKey = AttributeValue(\"_subscriberKey\") */\n    /* Error out if we dont have a subscriber key */\n    IF EMPTY(@SubscriberKey) THEN\n      SET @STATUS = @ERROR_NOSUB\n      SET @errorMessage = \"No subscriber key found.\"\n    ENDIF\n\n    /* Get and check for the email address */\n    IF @STATUS >= 0 THEN   \n      \n     /* Get the current subscribers subscriber object, and check their subscription status */\n      SET @currSubRequest=CreateObject(\"RetrieveRequest\")\n      SetObjectProperty(@currSubRequest,\"ObjectType\",\"Subscriber\")\n      AddObjectArrayItem(@currSubRequest,\"Properties\",\"SubscriberKey\")\n      AddObjectArrayItem(@currSubRequest,\"Properties\",\"Status\")\n      AddObjectArrayItem(@currSubRequest,\"Properties\",\"EmailAddress\")\n\n      SET @sfp=CreateObject(\"SimpleFilterPart\")\n      SetObjectProperty(@sfp,\"Property\",\"SubscriberKey\")\n      SetObjectProperty(@sfp,\"SimpleOperator\",\"equals\")\n      AddObjectArrayItem(@sfp,\"Value\",@subscriberKey)\n      SetObjectProperty(@currSubRequest,\"Filter\",@sfp)\n\n      SET @sub=InvokeRetrieve(@currSubRequest, @reqStatus)\n      IF RowCount(@sub) > 0 THEN /*Subscriber found */\n        SET @subfield = Row(@sub, 1)\n        SET @activityStatus = Field(@subfield, \"Status\")\n        SET @emailAddress = Field(@subfield, \"EmailAddress\")\n        \n        /* Determine if the subscriber is subscribed or not */\n        IF @activityStatus != \"Active\" THEN /*Subscriber is unsubscribed*/\n          SET @STATUS = @UNSUBBED_FLAG\n        ENDIF\n\n        /* Error out if we dont have an email address */\n        IF EMPTY(@emailAddress) THEN\n          SET @STATUS = @ERROR_NOEMAIL\n          SET @errorMessage = CONCAT(\"No email found for subscriber \",@subscriberKey,\".\")\n        ENDIF\n\n      ELSE/* Subscriber not found */\n        SET @STATUS = @ERROR_NOSUBFOUND\n        SET @errorMessage = CONCAT(\"No subscriber found in All Subscribers with current subscriber key \",@subscriberKey,\".\")\n      ENDIF\n\n    ENDIF\n]%%\n</div>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n    <link href=\"https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700\" rel=\"stylesheet\">\n\n    <style>\n      \n      \n      html, body {\n  height: 100%;\n}\n\n.toggle {\n  position: relative;\n  display: block;\n  width: 40px;\n  height: 20px;\n  cursor: pointer;\n  -webkit-tap-highlight-color: transparent;\n  transform: translate3d(0, 0, 0);\n}\n.toggle:before {\n  content: \"\";\n  position: relative;\n  top: 3px;\n  left: 3px;\n  width: 34px;\n  height: 14px;\n  display: block;\n  background: #9A9999;\n  border-radius: 8px;\n  transition: background 0.2s ease;\n}\n.toggle span {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 20px;\n  height: 20px;\n  display: block;\n  background: white;\n  border-radius: 10px;\n  box-shadow: 0 3px 8px rgba(154, 153, 153, 0.5);\n  transition: all 0.2s ease;\n}\n.toggle span:before {\n  content: \"\";\n  position: absolute;\n  display: block;\n  margin: -18px;\n  width: 56px;\n  height: 56px;\n  background: rgba(79, 46, 220, 0.5);\n  border-radius: 50%;\n  transform: scale(0);\n  opacity: 1;\n  pointer-events: none;\n}\n\n.cbx:checked + .toggle:before {\n  background: #5d8fda;\n}\n.cbx:checked + .toggle span {\n  background: #24559e;\n  transform: translateX(20px);\n  transition: all 0.2s cubic-bezier(0.8, 0.4, 0.3, 1.25), background 0.15s ease;\n  box-shadow: 0 3px 8px rgba(79, 46, 220, 0.2);\n}\n.cbx:checked + .toggle span:before {\n  transform: scale(1);\n  opacity: 0;\n  transition: all 0.4s ease;\n}\n\n.center {\n  position: absolute;\n  top: calc(50% - 10px);\n  left: calc(50% - 20px);\n}\n      \n      \n      \n      \n      * {\n         font-family: 'Montserrat', sans-serif;\n\n      }\n      h1 {\n        font-size: 42px;\n        font-weight: 600;\n        margin: 0px 0px;\n\n      }\n\n      h2 {\n        font-size: 28px;\n        font-weight: 600;\n        margin: 0px 0px;\n\n      }\n\n      h3 {\n        font-size: 22px;\n        font-weight: 600;\n        margin: 0px 0px;\n\n      }\n      .main-outer {\n        color: #000;\n        font-family: 'Montserrat', sans-serif;\n        font-size: 15px;\n        margin: 0 auto;\n        padding-bottom: 10px;\n        max-width: 1080px; \n      }\n      \n      .main-inner {\n        margin: 50px 20px 0px 20px;\n        \n      }\n      \n      .email-display {\n        text-align:left;\n        border: solid 1px grey; \n        border-radius:8px;\n        padding:0px 10px;\n        width: 450px\n      }\n      \n      .submit-button {\n        background-color: #2659a6;\n        border: none;\n        text-transform: uppercase;\n        border-radius: 20px;\n        text-align: center;\n        padding: 13px 27px;\n        color: white;\n        font-size: 16px;\n        font-weight: 600;\n      }\n      \n      .submit-button:hover {\n        background-color: #3372d1;\n        padding: 14px 29px;\n      }\n      p {\n       color: #808080; \n        margin: 10px 0px;\n\n      }\n      \n      .preference-box-ind {\n        display: inline-block; \n        width:90%; \n        vertical-align: middle;\n        \n      }\n\n      @media only screen and (max-width: 500px) {\n          .mobile-hidden {\n            display: none !important;\n          }\n\n          .email-display {\n            width: 300px; \n\n          }\n\n          .preference-box-ind {\n            width:80%;\n          }\n\n         h1 {\n          font-size: 36px;\n          font-weight: 600;\n          margin: 0px 0px;\n\n        }\n\n        h2 {\n          font-size: 24px;\n          font-weight: 600;\n          margin: 0px 0px;\n\n        }\n\n        h3 {\n          font-size: 20px;\n          font-weight: 600;\n          margin: 0px 0px;\n\n        }\n\n        .submit-button:hover {\n          padding: 14px 29px;\n        }\n\n        }\n      }\n\n    </style>\n  </head>\n\n  <body>\n    <div class=\"main-outer\">\n      <img style=\"width:100%; display:inline;\" src=\"https://via.placeholder.com/1796x933/808080/FFFFFF%20?text=PlaceholderHero\" alt=\"Header\">\n      \n      <div class=\"main-inner\">\n        <h1>\n          Email Preferences\n        </h1>\n        <p>\n          We don't like SPAM either.<br>Choose what you want to hear about below.\n        </p>\n        <br>\n        \n        %%[\n            IF @STATUS == @THANKS_FLAG THEN\n            SET @subscriberKey = RequestParameter(\"subkey\")\n           ]%%\n        <h3>\n          Thank you, your preferences have been updated.\n        </h3>\n\n        <br><br>\n        <form method=\"post\" action=\"%%=CloudPagesURL(\"2117\",\"subkey\",@subscriberKey)=%%\">\n            <input type=\"submit\" value=\"Back to Preferences\" class=\"submit-button\">\n        </form>\n\n        %%[\n            ELSEIF @STATUS < 0 THEN\n          ]%%\n        <h3>\n          An error has occured: %%=v(@errorMessage)=%%<br>Please try again later.\n        </h3>\n        %%[\n          ELSE\n          ]%%\n        \n        <div class=\"email-display\">\n\n          <div style=\"display: inline-block; vertical-align: middle;\">\n            <img style=\"width:40px; display:inline;\" src=\"https://e7.pngegg.com/pngimages/522/873/png-clipart-black-envelope-icon-advanced-case-management-envelope-computer-icons-icon-design-envelope-mail-miscellaneous-angle.png\" alt=\"Email:\">\n          </div>\n          \n          <div style=\"display: inline-block; padding-left: 10px;  vertical-align: middle;\">\n            <p style=\"color:#b8b8b8;font-size:14px\">\n              %%=v(@emailAddress)=%%\n            </p>\n          </div>\n        </div> <!-- email display -->\n        <br><br>\n\n        \n        \n        <form method=\"post\" action=\"%%=CloudPagesURL(\"2116\",\"subkey\",@subscriberKey)=%%\">\n          %%[\n              IF @STATUS == @UNSUBBED_FLAG THEN\n            ]%%\n          <hr><br>\n          <div class=\"preference-box-ind\">\n            <p id=\"paragraph\">If you would like to resubscribe into our marketing and promotional emails, please check the box then click \"Update Preferences.\"</p>\n          </div>\n          \n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" name=\"resubscribe\" id=\"cbxresubscribe\" style=\"display:none\"/>\n            <label for=\"cbxresubscribe\" class=\"toggle\"><span></span></label>\n          </div>\n         <br><br><hr>\n          \n          <br><br>\n          <input type=\"Submit\" value=\"Update Preferences\" class=\"submit-button\">\n          %%[\n           ELSE\n\n                  /* Get all the preferences in this BU from the DE SubscriberPreferences*/\n                  SET @preferenceRows = LookupOrderedRows(\"PreferenceCenter\", 0, \"SortOrder ASC\", \"IsActive\", \"True\")\n                  SET @preferenceCount = ROWCOUNT(@preferenceRows)\n\n                  /* Get all the preferences for this specific subscriber*/\n                  SET @subsPreferenceRows = LookupRows(\"SubscriberPreferences\", \"SubscriberKey\", @subscriberKey)\n                  SET @subPreferenceCount = ROWCOUNT(@subsPreferenceRows)\n\n                  SET @override = false\n                  IF @subPreferenceCount == 0 THEN\n                    Redirect(CloudPagesURL(2116,\"subkey\",@subscriberKey))/* Not updated yet, try again.*/\n                  ENDIF\n\n                  IF @preferenceCount != 0 THEN \n                      SET @subsPrefs = ROW(@subsPreferenceRows, 1)\n\n                      FOR @i = 1 TO @preferenceCount DO\n                          SET @prefCurrRow = ROW(@preferenceRows, @i)\n\n                          SET @preferenceId = FIELD(@prefCurrRow, \"PreferenceId\")\n                          SET @label = FIELD(@prefCurrRow, \"PreferenceLabel\")\n                          SET @description = FIELD(@prefCurrRow, \"PreferenceDescription\")\n\n\n                          SET @subOptInValue = Lookup(\"SubscriberPreferences\", \"OptinStatus\", \"SubscriberKey\", @subscriberKey,\"Preference\",@preferenceId)\n\n              ]%%\n          <div class=\"preference-box-ind\">\n            <h3>\n              %%=v(@label)=%%\n            </h3>\n            <p class=\"description\" >\n              %%=v(@description)=%%\n            </p> \n          </div>\n\n          %%[IF @subOptInValue == \"True\" THEN]%%\n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" name=\"%%=v(@preferenceId)=%%\" checked id=\"cbx%%=v(@preferenceId)=%%\" style=\"display:none\"/>\n            <label for=\"cbx%%=v(@preferenceId)=%%\" class=\"toggle\"><span></span></label>\n          </div>\n          %%[ELSE]%%\n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" name=\"%%=v(@preferenceId)=%%\" id=\"cbx%%=v(@preferenceId)=%%\" style=\"display:none\"/>\n            <label for=\"cbx%%=v(@preferenceId)=%%\" class=\"toggle\"><span></span></label>\n          </div>\n          %%[ENDIF]%%\n           <br><br>\n\n          \n          %%[ \n              NEXT \n             ENDIF /* ENDIF for preferences check*/\n            ]%%\n          \n          <hr><br>\n          <div class=\"preference-box-ind\">\n            <h3>\n             Opt out of all [COMPANY NAME] Communications\n            </h3>\n          </div>\n\n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" id=\"cbxunsub\" name=\"unsubscribe\" style=\"display:none\"/>\n            <label for=\"cbxunsub\" class=\"toggle\"><span></span></label>    \n          </div>\n          <br><br><hr>\n          \n          <br><br>\n          <input type=\"Submit\" value=\"Update Preferences\" class=\"submit-button\">\n          %%[ \n          ENDIF /* ENDIF for \"IF @STATUS == @UNSUBBED_FLAG THEN\" block*/\n         ENDIF /* ENDIF for \"IF @STATUS == @THANKS_FLAG THEN\" block*/\n         ]%%\n\n        </form>\n      </div>\n    </div>\n  </body>\n</html>\n\n\t\t</div>\n\t</div>\n</div>\n</body>\n</html>\n","isDefault":true,"isStaticContent":false,"name":"CPC_Main","siteId":"{{mcpm#/entities/primaryLandingPages/929575-2130/data/definition/landingPageId}}"},"name":"cpc_main","primaryId":"{{mcpm#/entities/primaryLandingPages/929575-2130/data/id}}","state":{"contentType":"text/html","description":"","name":"cpc_main","siteId":"{{mcpm#/entities/primaryLandingPages/929575-2130/data/definition/landingPageId}}"}}}},"microsites":{},"micrositePages":{},"micrositePageVersions":{},"primaryLandingPages":{"929574-2129":{"issues":[],"originID":"929574-2129","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"asset":{"assetType":{"id":205,"name":"webpage"},"name":"CPC_Handler","category":{"id":"{{mcpm#/entities/categories/398902/data/id}}"},"contentType":"text/html","meta":{"globalStyles":{"isLocked":false,"body":{"max-width":"1280px"}}},"views":{"html":{"thumbnail":{},"content":"<!DOCTYPE html>\n<html>\n<head>\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n\t<style class=\"main_style\">\n.layout-canvas-g {\n  background-color: #fff;\n  border: none;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  padding: 0;\n  width: 100%;\n}\n.layout-canvas-g > .header,\n.layout-canvas-g > .section,\n.layout-canvas-g > .footer {\n  position: relative;\n  overflow: hidden;\n  width: 100%;\n  word-wrap: break-word;\n}\n.layout-canvas-g > .section {\n  margin: 10px 0;\n}\n.layout-canvas-g > .section > .columns {\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  word-wrap: break-word;\n}\nbody {\n  color: #000;\n  font-family: Arial;\n  font-size: 12px;\n  margin: 0 auto;\n  max-width: 1280px;\n}\n@media only screen and (max-width: 480px) {\n  .mobile-hidden {\n    display: none !important;\n  }\n  .responsive-td {\n    width: 100% !important;\n    display: block !important;\n    padding: 0 !important;\n  }\n}\n.layout-canvas-g > .section > .columns {\n  width: 100%;\n}\n\n</style>\n\n</head>\n<body>\n<div class=\"layout layout-canvas-g\">\n\t<div class=\"section\">\n\t\t<div class=\"columns col1\">\n\t\t\t<div data-type=\"slot\" data-key=\"col1\"></div>\n\t\t</div>\n\t</div>\n</div>\n</body>\n</html>\n","meta":{},"slots":{"col1":{"content":"<div data-type=\"block\" data-key=\"0nelopei5hpe\"></div>","design":"<p style=\"font-family:arial;color:#ccc;font-size:11px;text-align:center;vertical-align:middle;font-weight:bold;padding:10px;margin:0;border:#ccc dashed 1px;\">Drop blocks or content here</p>","blocks":{"0nelopei5hpe":{"assetType":{"id":220,"name":"codesnippetblock"},"content":"%%[\nSET @versionControl = 1.1\nSET @debug = \"\"\n\n/* STATUS FLAGS */\nSET @UNSUBBED = 1\nSET @STATUS_FLAG = 0\nSET @ERROR_NOSUB = -1\n\n/* GLOBAL FIELD NAMES */\nSET @unsubscribeName = \"unsubscribe\"\nSET @resubscribeName = \"resubscribe\"\nSET @overrideResubscribe = \"optin\"\nSET @overrideUnsubscribe = \"optout\"\nVAR @override\nSET @override = \"0\"\n\n/* Get and check for the subscriber key */\nSET @subscriberKey = RequestParameter(\"subkey\")\n/* Error out if we dont have a subscriber key */\nIF EMPTY(@subscriberKey) THEN\n  SET @STATUS_FLAG = @ERROR_NOSUB\nENDIF\n\n/* ----------------- Net New Subscriber Auto Preference Opt-in -----------------------*/\n\n/* Get all the preferences for this specific subscriber*/\nSET @subsPreferenceRows = LookupRows(\"SubscriberPreferences\", \"SubscriberKey\", @subscriberKey)\nSET @subPreferenceCount = ROWCOUNT(@subsPreferenceRows)\n\nIF @subPreferenceCount == 0 THEN\n  SET @preferenceRows = LookupOrderedRows(\"PreferenceCenter\", 0, \"SortOrder ASC\", \"IsActive\", \"True\")\n  SET @preferenceCount = ROWCOUNT(@preferenceRows)\n  FOR @i = 1 TO @preferenceCount DO\n      SET @prefCurrRow = ROW(@preferenceRows, @i)\n      SET @preferenceId = FIELD(@prefCurrRow, \"PreferenceId\")\n      InsertData(\"SubscriberPreferences\", \"SubscriberKey\", @subscriberKey, \"Preference\", @preferenceId, \"OptinStatus\", \"TRUE\",\"LastUpdatedDate\", Now())\n  NEXT\n  Redirect(CloudPagesURL(2117,\"thankyou\",\"0\",\"subkey\",@subscriberKey))\nENDIF\n\n/* ----------------- Complete global unsubscribes -----------------------*/\nSET @unsubscribe = RequestParameter(@unsubscribeName)\nIF NOT EMPTY(@unsubscribe) THEN\n\n SET @debug = Concat(@debug,@unsubscribe)\n \n    SET @override = @overrideUnsubscribe\n\n    /* Unsubscribe from all subscribers */\n    SET @jid = JobID\n    SET @listid = ListID\n    SET @batchid = _JobSubscriberBatchID\n    SET @reason = \"Landing Page Unsubscribe\"\n\n    SET @lue = CreateObject(\"ExecuteRequest\")\n    SetObjectProperty(@lue,\"Name\",\"LogUnsubEvent\")\n\n    SET @lue_prop = CreateObject(\"APIProperty\")                 \n    SetObjectProperty(@lue_prop, \"Name\", \"SubscriberKey\")\n    SetObjectProperty(@lue_prop, \"Value\", @subscriberKey)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"JobID\")\n    SetObjectProperty(@lue_prop, \"Value\", @jid)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"ListID\")\n    SetObjectProperty(@lue_prop, \"Value\", @listid)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"BatchID\")\n    SetObjectProperty(@lue_prop, \"Value\", @batchid)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"Reason\")\n    SetObjectProperty(@lue_prop, \"Value\", @reason)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_statusCode = InvokeExecute(@lue, @overallStatus, @requestId)\n\n    SET @lue_Response = Row(@lue_statusCode, 1)\n    SET @lue_Status = Field(@lue_Response,\"StatusMessage\")\n    SET @lue_Error = Field(@lue_Response,\"ErrorCode\")\n\n    SET @debug = Concat(@debug,Concat(\" - Unsubbing subscriber from all subs: \",@subscriberKey, @lue_Status))\n \nENDIF\n/* ----------------- End of global unsubscribes -----------------------*/\n\n/* ----------------- Start of resubscribe -----------------------*/\nSET @resubscribe = RequestParameter(@resubscribeName)\nIF NOT EMPTY(@resubscribe) THEN\n\n  SET @override = @overrideResubscribe\n  SET @sub = CreateObject(\"Subscriber\")\n  SetObjectProperty(@sub, \"SubscriberKey\", @subscriberKey)\n  SetObjectProperty(@sub, \"Status\", \"Active\")\n  SET @updateStatusCode = InvokeUpdate(@sub, @updateStatusMessage, @updateErrorCode, @updateOptions)\n  SET @debug = Concat(@debug,Concat(\" - resubbing subscriber from all subs: \",@subscriberKey, @updateStatusCode))\n\nENDIF\n/* ----------------- End of resubscribe -----------------------*/\n\n/* ----------------- Start of program specific changes -----------------------*/\n/* On Unsub = Opt out of everything, Resub = Opt into everything\n   else = Opt into/outof whatever is in the payload              */\n   \nSET @rows = LookupRows(\"PreferenceCenter\",\"IsActive\", \"True\")\n\nFOR @counter = 1 TO ROWCOUNT(@rows) DO\n\n  SET @currentRow = row(@rows, @counter)\n\n  /* Get the current program */\n  SET @progName = field(@currentRow, \"PreferenceId\")\n\n  /* Check if an override is set, if not then request parameter from payload*/\n  IF @override == @overrideResubscribe THEN\n    SET @progOptIn = \"true\"\n  ELSEIF @override == @overrideUnsubscribe THEN\n    SET @progOptIn = \"\"\n  ELSE\n    SET @progOptIn = RequestParameter(@progName)\n  ENDIF\n\n  IF NOT EMPTY(@progOptIn) THEN\n   /* The current row matches a program they want to subscribe into */\n    UpsertData(\"SubscriberPreferences\",2,\"SubscriberKey\", @subscriberKey, \"Preference\", @progName, \"OptinStatus\", \"True\", \"LastUpdatedDate\", NOW())\n    SET @debug = Concat(@debug,Concat(\" - Subbing \",@subscriberKey, \" into program \",@progName))\n  ELSE\n     /* The current row doesnt match a program they want to subscribe into - therefor they are unsubbed from it */\n    UpsertData(\"SubscriberPreferences\",2,\"SubscriberKey\", @subscriberKey, \"Preference\", @progName, \"OptinStatus\", \"False\", \"LastUpdatedDate\", NOW())\n    SET @debug = Concat(@debug,Concat(\" - Unsubbing \",@subscriberKey, \" from program \",@progName))\n  ENDIF\n\nNEXT\n/* ----------------- End of program specific changes -----------------------*/\n ]%%\n\n%%[Redirect(CloudPagesURL(2117,\"thankyou\",\"1\",\"subkey\",@subscriberKey))]%%","design":"<div class=\"default-design\"><div style=\"width:100%;height:150px;background: url(data:image/png;base64,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) repeat-x 0 0\"></div></div>","meta":{},"modelVersion":2}},"modelVersion":2}},"modelVersion":2}}},"content":{"channelTypeId":3,"contentType":"text/html","html":"<!DOCTYPE html>\n<html>\n<head>\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n\t<style class=\"main_style\">\n.layout-canvas-g {\n  background-color: #fff;\n  border: none;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  padding: 0;\n  width: 100%;\n}\n.layout-canvas-g > .header,\n.layout-canvas-g > .section,\n.layout-canvas-g > .footer {\n  position: relative;\n  overflow: hidden;\n  width: 100%;\n  word-wrap: break-word;\n}\n.layout-canvas-g > .section {\n  margin: 10px 0;\n}\n.layout-canvas-g > .section > .columns {\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  word-wrap: break-word;\n}\nbody {\n  color: #000;\n  font-family: Arial;\n  font-size: 12px;\n  margin: 0 auto;\n  max-width: 1280px;\n}\n@media only screen and (max-width: 480px) {\n  .mobile-hidden {\n    display: none !important;\n  }\n  .responsive-td {\n    width: 100% !important;\n    display: block !important;\n    padding: 0 !important;\n  }\n}\n.layout-canvas-g > .section > .columns {\n  width: 100%;\n}\n\n</style>\n\n</head>\n<body>\n<div class=\"layout layout-canvas-g\">\n\t<div class=\"section\">\n\t\t<div class=\"columns col1\">\n\t\t\t%%[\nSET @versionControl = 1.1\nSET @debug = \"\"\n\n/* STATUS FLAGS */\nSET @UNSUBBED = 1\nSET @STATUS_FLAG = 0\nSET @ERROR_NOSUB = -1\n\n/* GLOBAL FIELD NAMES */\nSET @unsubscribeName = \"unsubscribe\"\nSET @resubscribeName = \"resubscribe\"\nSET @overrideResubscribe = \"optin\"\nSET @overrideUnsubscribe = \"optout\"\nVAR @override\nSET @override = \"0\"\n\n/* Get and check for the subscriber key */\nSET @subscriberKey = RequestParameter(\"subkey\")\n/* Error out if we dont have a subscriber key */\nIF EMPTY(@subscriberKey) THEN\n  SET @STATUS_FLAG = @ERROR_NOSUB\nENDIF\n\n/* ----------------- Net New Subscriber Auto Preference Opt-in -----------------------*/\n\n/* Get all the preferences for this specific subscriber*/\nSET @subsPreferenceRows = LookupRows(\"SubscriberPreferences\", \"SubscriberKey\", @subscriberKey)\nSET @subPreferenceCount = ROWCOUNT(@subsPreferenceRows)\n\nIF @subPreferenceCount == 0 THEN\n  SET @preferenceRows = LookupOrderedRows(\"PreferenceCenter\", 0, \"SortOrder ASC\", \"IsActive\", \"True\")\n  SET @preferenceCount = ROWCOUNT(@preferenceRows)\n  FOR @i = 1 TO @preferenceCount DO\n      SET @prefCurrRow = ROW(@preferenceRows, @i)\n      SET @preferenceId = FIELD(@prefCurrRow, \"PreferenceId\")\n      InsertData(\"SubscriberPreferences\", \"SubscriberKey\", @subscriberKey, \"Preference\", @preferenceId, \"OptinStatus\", \"TRUE\",\"LastUpdatedDate\", Now())\n  NEXT\n  Redirect(CloudPagesURL(2117,\"thankyou\",\"0\",\"subkey\",@subscriberKey))\nENDIF\n\n/* ----------------- Complete global unsubscribes -----------------------*/\nSET @unsubscribe = RequestParameter(@unsubscribeName)\nIF NOT EMPTY(@unsubscribe) THEN\n\n SET @debug = Concat(@debug,@unsubscribe)\n \n    SET @override = @overrideUnsubscribe\n\n    /* Unsubscribe from all subscribers */\n    SET @jid = JobID\n    SET @listid = ListID\n    SET @batchid = _JobSubscriberBatchID\n    SET @reason = \"Landing Page Unsubscribe\"\n\n    SET @lue = CreateObject(\"ExecuteRequest\")\n    SetObjectProperty(@lue,\"Name\",\"LogUnsubEvent\")\n\n    SET @lue_prop = CreateObject(\"APIProperty\")                 \n    SetObjectProperty(@lue_prop, \"Name\", \"SubscriberKey\")\n    SetObjectProperty(@lue_prop, \"Value\", @subscriberKey)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"JobID\")\n    SetObjectProperty(@lue_prop, \"Value\", @jid)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"ListID\")\n    SetObjectProperty(@lue_prop, \"Value\", @listid)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"BatchID\")\n    SetObjectProperty(@lue_prop, \"Value\", @batchid)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_prop = CreateObject(\"APIProperty\")\n    SetObjectProperty(@lue_prop, \"Name\", \"Reason\")\n    SetObjectProperty(@lue_prop, \"Value\", @reason)\n    AddObjectArrayItem(@lue, \"Parameters\", @lue_prop)\n\n    SET @lue_statusCode = InvokeExecute(@lue, @overallStatus, @requestId)\n\n    SET @lue_Response = Row(@lue_statusCode, 1)\n    SET @lue_Status = Field(@lue_Response,\"StatusMessage\")\n    SET @lue_Error = Field(@lue_Response,\"ErrorCode\")\n\n    SET @debug = Concat(@debug,Concat(\" - Unsubbing subscriber from all subs: \",@subscriberKey, @lue_Status))\n \nENDIF\n/* ----------------- End of global unsubscribes -----------------------*/\n\n/* ----------------- Start of resubscribe -----------------------*/\nSET @resubscribe = RequestParameter(@resubscribeName)\nIF NOT EMPTY(@resubscribe) THEN\n\n  SET @override = @overrideResubscribe\n  SET @sub = CreateObject(\"Subscriber\")\n  SetObjectProperty(@sub, \"SubscriberKey\", @subscriberKey)\n  SetObjectProperty(@sub, \"Status\", \"Active\")\n  SET @updateStatusCode = InvokeUpdate(@sub, @updateStatusMessage, @updateErrorCode, @updateOptions)\n  SET @debug = Concat(@debug,Concat(\" - resubbing subscriber from all subs: \",@subscriberKey, @updateStatusCode))\n\nENDIF\n/* ----------------- End of resubscribe -----------------------*/\n\n/* ----------------- Start of program specific changes -----------------------*/\n/* On Unsub = Opt out of everything, Resub = Opt into everything\n   else = Opt into/outof whatever is in the payload              */\n   \nSET @rows = LookupRows(\"PreferenceCenter\",\"IsActive\", \"True\")\n\nFOR @counter = 1 TO ROWCOUNT(@rows) DO\n\n  SET @currentRow = row(@rows, @counter)\n\n  /* Get the current program */\n  SET @progName = field(@currentRow, \"PreferenceId\")\n\n  /* Check if an override is set, if not then request parameter from payload*/\n  IF @override == @overrideResubscribe THEN\n    SET @progOptIn = \"true\"\n  ELSEIF @override == @overrideUnsubscribe THEN\n    SET @progOptIn = \"\"\n  ELSE\n    SET @progOptIn = RequestParameter(@progName)\n  ENDIF\n\n  IF NOT EMPTY(@progOptIn) THEN\n   /* The current row matches a program they want to subscribe into */\n    UpsertData(\"SubscriberPreferences\",2,\"SubscriberKey\", @subscriberKey, \"Preference\", @progName, \"OptinStatus\", \"True\", \"LastUpdatedDate\", NOW())\n    SET @debug = Concat(@debug,Concat(\" - Subbing \",@subscriberKey, \" into program \",@progName))\n  ELSE\n     /* The current row doesnt match a program they want to subscribe into - therefor they are unsubbed from it */\n    UpsertData(\"SubscriberPreferences\",2,\"SubscriberKey\", @subscriberKey, \"Preference\", @progName, \"OptinStatus\", \"False\", \"LastUpdatedDate\", NOW())\n    SET @debug = Concat(@debug,Concat(\" - Unsubbing \",@subscriberKey, \" from program \",@progName))\n  ENDIF\n\nNEXT\n/* ----------------- End of program specific changes -----------------------*/\n ]%%\n\n%%[Redirect(CloudPagesURL(2117,\"thankyou\",\"1\",\"subkey\",@subscriberKey))]%%\n\t\t</div>\n\t</div>\n</div>\n</body>\n</html>\n","isDefault":true,"isStaticContent":false,"name":"CPC_Handler"},"definition":{"collectionId":"{{mcpm#/entities/cloudPageCollections/1125/data/collectionId}}","description":"Custom preference center logic handling page where cpc_main redirects to and from","domain":"{{mcpm:cloudPages-domain}}","isNoFollow":false,"isNoIndex":false,"key":"fkdbrqzhdzk","name":"cpc_handler","pageTypeId":3,"requiresSsl":true,"url":"https://mcf7bhdjzswk278tj2j38nqtlq2q.pub.sfmc-content.com/fkdbrqzhdzk"},"name":"cpc_handler","state":{"contentType":"text/html","description":"","name":"cpc_handler"}}},"929575-2130":{"issues":[],"originID":"929575-2130","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"asset":{"assetType":{"id":205,"name":"webpage"},"name":"CPC_Main","category":{"id":"{{mcpm#/entities/categories/398902/data/id}}"},"contentType":"text/html","meta":{"globalStyles":{"isLocked":false,"body":{"max-width":"1280px"}}},"views":{"html":{"thumbnail":{},"content":"<!DOCTYPE html>\n<html>\n<head>\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n\t<style class=\"main_style\">\n.layout-canvas-g {\n  background-color: #fff;\n  border: none;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  padding: 0;\n  width: 100%;\n}\n.layout-canvas-g > .header,\n.layout-canvas-g > .section,\n.layout-canvas-g > .footer {\n  position: relative;\n  overflow: hidden;\n  width: 100%;\n  word-wrap: break-word;\n}\n.layout-canvas-g > .section {\n  margin: 10px 0;\n}\n.layout-canvas-g > .section > .columns {\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  word-wrap: break-word;\n}\nbody {\n  color: #000;\n  font-family: Arial;\n  font-size: 12px;\n  margin: 0 auto;\n  max-width: 1280px;\n}\n@media only screen and (max-width: 480px) {\n  .mobile-hidden {\n    display: none !important;\n  }\n  .responsive-td {\n    width: 100% !important;\n    display: block !important;\n    padding: 0 !important;\n  }\n}\n.layout-canvas-g > .section > .columns {\n  width: 100%;\n}\n\n</style>\n\n</head>\n<body>\n<div class=\"layout layout-canvas-g\">\n\t<div class=\"section\">\n\t\t<div class=\"columns col1\">\n\t\t\t<div data-type=\"slot\" data-key=\"col1\"></div>\n\t\t</div>\n\t</div>\n</div>\n</body>\n</html>\n","meta":{},"slots":{"col1":{"content":"<div data-type=\"block\" data-key=\"1wsz97pdf3n\"></div>","design":"<p style=\"font-family:arial;color:#ccc;font-size:11px;text-align:center;vertical-align:middle;font-weight:bold;padding:10px;margin:0;border:#ccc dashed 1px;\">Drop blocks or content here</p>","blocks":{"1wsz97pdf3n":{"assetType":{"id":220,"name":"codesnippetblock"},"content":"<div style=\"display:none;\">\n%%[\n    SET @versionControl = \"1.0\"\n    /* STILL HAVE TO COMPLETE NEW ARRIVAL BEHAVIOR */\n\n    /* STATUS FLAGS */\n    SET @STATUS = 0\n    SET @UNSUBBED_FLAG = 1\n    SET @THANKS_FLAG = 2\n    \n    SET @ERROR_NOSUB = -1\n    SET @ERROR_NOEMAIL = -2\n    SET @ERROR_NOSUBFOUND = -4 /* No sub in all subscribers */\n    SET @errorMessage = \"\"\n\n    \n    SET @STATUS_PARAM = RequestParameter(\"thankyou\")\n    IF @STATUS_PARAM == \"1\" THEN\n      SET @STATUS= @THANKS_FLAG\n    ENDIF\n    /* END OF STATUS FLAGS */\n\n\n    /* Get and check for the subscriber key */\n    SET @subscriberKey = RequestParameter(\"subkey\")\n    /* SET @subscriberKey = AttributeValue(\"_subscriberKey\") */\n    /* Error out if we dont have a subscriber key */\n    IF EMPTY(@SubscriberKey) THEN\n      SET @STATUS = @ERROR_NOSUB\n      SET @errorMessage = \"No subscriber key found.\"\n    ENDIF\n\n    /* Get and check for the email address */\n    IF @STATUS >= 0 THEN   \n      \n     /* Get the current subscribers subscriber object, and check their subscription status */\n      SET @currSubRequest=CreateObject(\"RetrieveRequest\")\n      SetObjectProperty(@currSubRequest,\"ObjectType\",\"Subscriber\")\n      AddObjectArrayItem(@currSubRequest,\"Properties\",\"SubscriberKey\")\n      AddObjectArrayItem(@currSubRequest,\"Properties\",\"Status\")\n      AddObjectArrayItem(@currSubRequest,\"Properties\",\"EmailAddress\")\n\n      SET @sfp=CreateObject(\"SimpleFilterPart\")\n      SetObjectProperty(@sfp,\"Property\",\"SubscriberKey\")\n      SetObjectProperty(@sfp,\"SimpleOperator\",\"equals\")\n      AddObjectArrayItem(@sfp,\"Value\",@subscriberKey)\n      SetObjectProperty(@currSubRequest,\"Filter\",@sfp)\n\n      SET @sub=InvokeRetrieve(@currSubRequest, @reqStatus)\n      IF RowCount(@sub) > 0 THEN /*Subscriber found */\n        SET @subfield = Row(@sub, 1)\n        SET @activityStatus = Field(@subfield, \"Status\")\n        SET @emailAddress = Field(@subfield, \"EmailAddress\")\n        \n        /* Determine if the subscriber is subscribed or not */\n        IF @activityStatus != \"Active\" THEN /*Subscriber is unsubscribed*/\n          SET @STATUS = @UNSUBBED_FLAG\n        ENDIF\n\n        /* Error out if we dont have an email address */\n        IF EMPTY(@emailAddress) THEN\n          SET @STATUS = @ERROR_NOEMAIL\n          SET @errorMessage = CONCAT(\"No email found for subscriber \",@subscriberKey,\".\")\n        ENDIF\n\n      ELSE/* Subscriber not found */\n        SET @STATUS = @ERROR_NOSUBFOUND\n        SET @errorMessage = CONCAT(\"No subscriber found in All Subscribers with current subscriber key \",@subscriberKey,\".\")\n      ENDIF\n\n    ENDIF\n]%%\n</div>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n    <link href=\"https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700\" rel=\"stylesheet\">\n\n    <style>\n      \n      \n      html, body {\n  height: 100%;\n}\n\n.toggle {\n  position: relative;\n  display: block;\n  width: 40px;\n  height: 20px;\n  cursor: pointer;\n  -webkit-tap-highlight-color: transparent;\n  transform: translate3d(0, 0, 0);\n}\n.toggle:before {\n  content: \"\";\n  position: relative;\n  top: 3px;\n  left: 3px;\n  width: 34px;\n  height: 14px;\n  display: block;\n  background: #9A9999;\n  border-radius: 8px;\n  transition: background 0.2s ease;\n}\n.toggle span {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 20px;\n  height: 20px;\n  display: block;\n  background: white;\n  border-radius: 10px;\n  box-shadow: 0 3px 8px rgba(154, 153, 153, 0.5);\n  transition: all 0.2s ease;\n}\n.toggle span:before {\n  content: \"\";\n  position: absolute;\n  display: block;\n  margin: -18px;\n  width: 56px;\n  height: 56px;\n  background: rgba(79, 46, 220, 0.5);\n  border-radius: 50%;\n  transform: scale(0);\n  opacity: 1;\n  pointer-events: none;\n}\n\n.cbx:checked + .toggle:before {\n  background: #5d8fda;\n}\n.cbx:checked + .toggle span {\n  background: #24559e;\n  transform: translateX(20px);\n  transition: all 0.2s cubic-bezier(0.8, 0.4, 0.3, 1.25), background 0.15s ease;\n  box-shadow: 0 3px 8px rgba(79, 46, 220, 0.2);\n}\n.cbx:checked + .toggle span:before {\n  transform: scale(1);\n  opacity: 0;\n  transition: all 0.4s ease;\n}\n\n.center {\n  position: absolute;\n  top: calc(50% - 10px);\n  left: calc(50% - 20px);\n}\n      \n      \n      \n      \n      * {\n         font-family: 'Montserrat', sans-serif;\n\n      }\n      h1 {\n        font-size: 42px;\n        font-weight: 600;\n        margin: 0px 0px;\n\n      }\n\n      h2 {\n        font-size: 28px;\n        font-weight: 600;\n        margin: 0px 0px;\n\n      }\n\n      h3 {\n        font-size: 22px;\n        font-weight: 600;\n        margin: 0px 0px;\n\n      }\n      .main-outer {\n        color: #000;\n        font-family: 'Montserrat', sans-serif;\n        font-size: 15px;\n        margin: 0 auto;\n        padding-bottom: 10px;\n        max-width: 1080px; \n      }\n      \n      .main-inner {\n        margin: 50px 20px 0px 20px;\n        \n      }\n      \n      .email-display {\n        text-align:left;\n        border: solid 1px grey; \n        border-radius:8px;\n        padding:0px 10px;\n        width: 450px\n      }\n      \n      .submit-button {\n        background-color: #2659a6;\n        border: none;\n        text-transform: uppercase;\n        border-radius: 20px;\n        text-align: center;\n        padding: 13px 27px;\n        color: white;\n        font-size: 16px;\n        font-weight: 600;\n      }\n      \n      .submit-button:hover {\n        background-color: #3372d1;\n        padding: 14px 29px;\n      }\n      p {\n       color: #808080; \n        margin: 10px 0px;\n\n      }\n      \n      .preference-box-ind {\n        display: inline-block; \n        width:90%; \n        vertical-align: middle;\n        \n      }\n\n      @media only screen and (max-width: 500px) {\n          .mobile-hidden {\n            display: none !important;\n          }\n\n          .email-display {\n            width: 300px; \n\n          }\n\n          .preference-box-ind {\n            width:80%;\n          }\n\n         h1 {\n          font-size: 36px;\n          font-weight: 600;\n          margin: 0px 0px;\n\n        }\n\n        h2 {\n          font-size: 24px;\n          font-weight: 600;\n          margin: 0px 0px;\n\n        }\n\n        h3 {\n          font-size: 20px;\n          font-weight: 600;\n          margin: 0px 0px;\n\n        }\n\n        .submit-button:hover {\n          padding: 14px 29px;\n        }\n\n        }\n      }\n\n    </style>\n  </head>\n\n  <body>\n    <div class=\"main-outer\">\n      <img style=\"width:100%; display:inline;\" src=\"https://via.placeholder.com/1796x933/808080/FFFFFF%20?text=PlaceholderHero\" alt=\"Header\">\n      \n      <div class=\"main-inner\">\n        <h1>\n          Email Preferences\n        </h1>\n        <p>\n          We don't like SPAM either.<br>Choose what you want to hear about below.\n        </p>\n        <br>\n        \n        %%[\n            IF @STATUS == @THANKS_FLAG THEN\n            SET @subscriberKey = RequestParameter(\"subkey\")\n           ]%%\n        <h3>\n          Thank you, your preferences have been updated.\n        </h3>\n\n        <br><br>\n        <form method=\"post\" action=\"%%=CloudPagesURL(\"2117\",\"subkey\",@subscriberKey)=%%\">\n            <input type=\"submit\" value=\"Back to Preferences\" class=\"submit-button\">\n        </form>\n\n        %%[\n            ELSEIF @STATUS < 0 THEN\n          ]%%\n        <h3>\n          An error has occured: %%=v(@errorMessage)=%%<br>Please try again later.\n        </h3>\n        %%[\n          ELSE\n          ]%%\n        \n        <div class=\"email-display\">\n\n          <div style=\"display: inline-block; vertical-align: middle;\">\n            <img style=\"width:40px; display:inline;\" src=\"https://e7.pngegg.com/pngimages/522/873/png-clipart-black-envelope-icon-advanced-case-management-envelope-computer-icons-icon-design-envelope-mail-miscellaneous-angle.png\" alt=\"Email:\">\n          </div>\n          \n          <div style=\"display: inline-block; padding-left: 10px;  vertical-align: middle;\">\n            <p style=\"color:#b8b8b8;font-size:14px\">\n              %%=v(@emailAddress)=%%\n            </p>\n          </div>\n        </div> <!-- email display -->\n        <br><br>\n\n        \n        \n        <form method=\"post\" action=\"%%=CloudPagesURL(\"2116\",\"subkey\",@subscriberKey)=%%\">\n          %%[\n              IF @STATUS == @UNSUBBED_FLAG THEN\n            ]%%\n          <hr><br>\n          <div class=\"preference-box-ind\">\n            <p id=\"paragraph\">If you would like to resubscribe into our marketing and promotional emails, please check the box then click \"Update Preferences.\"</p>\n          </div>\n          \n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" name=\"resubscribe\" id=\"cbxresubscribe\" style=\"display:none\"/>\n            <label for=\"cbxresubscribe\" class=\"toggle\"><span></span></label>\n          </div>\n         <br><br><hr>\n          \n          <br><br>\n          <input type=\"Submit\" value=\"Update Preferences\" class=\"submit-button\">\n          %%[\n           ELSE\n\n                  /* Get all the preferences in this BU from the DE SubscriberPreferences*/\n                  SET @preferenceRows = LookupOrderedRows(\"PreferenceCenter\", 0, \"SortOrder ASC\", \"IsActive\", \"True\")\n                  SET @preferenceCount = ROWCOUNT(@preferenceRows)\n\n                  /* Get all the preferences for this specific subscriber*/\n                  SET @subsPreferenceRows = LookupRows(\"SubscriberPreferences\", \"SubscriberKey\", @subscriberKey)\n                  SET @subPreferenceCount = ROWCOUNT(@subsPreferenceRows)\n\n                  SET @override = false\n                  IF @subPreferenceCount == 0 THEN\n                    Redirect(CloudPagesURL(2116,\"subkey\",@subscriberKey))/* Not updated yet, try again.*/\n                  ENDIF\n\n                  IF @preferenceCount != 0 THEN \n                      SET @subsPrefs = ROW(@subsPreferenceRows, 1)\n\n                      FOR @i = 1 TO @preferenceCount DO\n                          SET @prefCurrRow = ROW(@preferenceRows, @i)\n\n                          SET @preferenceId = FIELD(@prefCurrRow, \"PreferenceId\")\n                          SET @label = FIELD(@prefCurrRow, \"PreferenceLabel\")\n                          SET @description = FIELD(@prefCurrRow, \"PreferenceDescription\")\n\n\n                          SET @subOptInValue = Lookup(\"SubscriberPreferences\", \"OptinStatus\", \"SubscriberKey\", @subscriberKey,\"Preference\",@preferenceId)\n\n              ]%%\n          <div class=\"preference-box-ind\">\n            <h3>\n              %%=v(@label)=%%\n            </h3>\n            <p class=\"description\" >\n              %%=v(@description)=%%\n            </p> \n          </div>\n\n          %%[IF @subOptInValue == \"True\" THEN]%%\n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" name=\"%%=v(@preferenceId)=%%\" checked id=\"cbx%%=v(@preferenceId)=%%\" style=\"display:none\"/>\n            <label for=\"cbx%%=v(@preferenceId)=%%\" class=\"toggle\"><span></span></label>\n          </div>\n          %%[ELSE]%%\n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" name=\"%%=v(@preferenceId)=%%\" id=\"cbx%%=v(@preferenceId)=%%\" style=\"display:none\"/>\n            <label for=\"cbx%%=v(@preferenceId)=%%\" class=\"toggle\"><span></span></label>\n          </div>\n          %%[ENDIF]%%\n           <br><br>\n\n          \n          %%[ \n              NEXT \n             ENDIF /* ENDIF for preferences check*/\n            ]%%\n          \n          <hr><br>\n          <div class=\"preference-box-ind\">\n            <h3>\n             Opt out of all [COMPANY NAME] Communications\n            </h3>\n          </div>\n\n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" id=\"cbxunsub\" name=\"unsubscribe\" style=\"display:none\"/>\n            <label for=\"cbxunsub\" class=\"toggle\"><span></span></label>    \n          </div>\n          <br><br><hr>\n          \n          <br><br>\n          <input type=\"Submit\" value=\"Update Preferences\" class=\"submit-button\">\n          %%[ \n          ENDIF /* ENDIF for \"IF @STATUS == @UNSUBBED_FLAG THEN\" block*/\n         ENDIF /* ENDIF for \"IF @STATUS == @THANKS_FLAG THEN\" block*/\n         ]%%\n\n        </form>\n      </div>\n    </div>\n  </body>\n</html>\n","design":"<div class=\"default-design\"><div style=\"width:100%;height:150px;background: url(data:image/png;base64,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) repeat-x 0 0\"></div></div>","meta":{},"modelVersion":2}},"modelVersion":2}},"modelVersion":2}}},"content":{"channelTypeId":3,"contentType":"text/html","html":"<!DOCTYPE html>\n<html>\n<head>\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n\t<style class=\"main_style\">\n.layout-canvas-g {\n  background-color: #fff;\n  border: none;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  padding: 0;\n  width: 100%;\n}\n.layout-canvas-g > .header,\n.layout-canvas-g > .section,\n.layout-canvas-g > .footer {\n  position: relative;\n  overflow: hidden;\n  width: 100%;\n  word-wrap: break-word;\n}\n.layout-canvas-g > .section {\n  margin: 10px 0;\n}\n.layout-canvas-g > .section > .columns {\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  word-wrap: break-word;\n}\nbody {\n  color: #000;\n  font-family: Arial;\n  font-size: 12px;\n  margin: 0 auto;\n  max-width: 1280px;\n}\n@media only screen and (max-width: 480px) {\n  .mobile-hidden {\n    display: none !important;\n  }\n  .responsive-td {\n    width: 100% !important;\n    display: block !important;\n    padding: 0 !important;\n  }\n}\n.layout-canvas-g > .section > .columns {\n  width: 100%;\n}\n\n</style>\n\n</head>\n<body>\n<div class=\"layout layout-canvas-g\">\n\t<div class=\"section\">\n\t\t<div class=\"columns col1\">\n\t\t\t<div style=\"display:none;\">\n%%[\n    SET @versionControl = \"1.0\"\n    /* STILL HAVE TO COMPLETE NEW ARRIVAL BEHAVIOR */\n\n    /* STATUS FLAGS */\n    SET @STATUS = 0\n    SET @UNSUBBED_FLAG = 1\n    SET @THANKS_FLAG = 2\n    \n    SET @ERROR_NOSUB = -1\n    SET @ERROR_NOEMAIL = -2\n    SET @ERROR_NOSUBFOUND = -4 /* No sub in all subscribers */\n    SET @errorMessage = \"\"\n\n    \n    SET @STATUS_PARAM = RequestParameter(\"thankyou\")\n    IF @STATUS_PARAM == \"1\" THEN\n      SET @STATUS= @THANKS_FLAG\n    ENDIF\n    /* END OF STATUS FLAGS */\n\n\n    /* Get and check for the subscriber key */\n    SET @subscriberKey = RequestParameter(\"subkey\")\n    /* SET @subscriberKey = AttributeValue(\"_subscriberKey\") */\n    /* Error out if we dont have a subscriber key */\n    IF EMPTY(@SubscriberKey) THEN\n      SET @STATUS = @ERROR_NOSUB\n      SET @errorMessage = \"No subscriber key found.\"\n    ENDIF\n\n    /* Get and check for the email address */\n    IF @STATUS >= 0 THEN   \n      \n     /* Get the current subscribers subscriber object, and check their subscription status */\n      SET @currSubRequest=CreateObject(\"RetrieveRequest\")\n      SetObjectProperty(@currSubRequest,\"ObjectType\",\"Subscriber\")\n      AddObjectArrayItem(@currSubRequest,\"Properties\",\"SubscriberKey\")\n      AddObjectArrayItem(@currSubRequest,\"Properties\",\"Status\")\n      AddObjectArrayItem(@currSubRequest,\"Properties\",\"EmailAddress\")\n\n      SET @sfp=CreateObject(\"SimpleFilterPart\")\n      SetObjectProperty(@sfp,\"Property\",\"SubscriberKey\")\n      SetObjectProperty(@sfp,\"SimpleOperator\",\"equals\")\n      AddObjectArrayItem(@sfp,\"Value\",@subscriberKey)\n      SetObjectProperty(@currSubRequest,\"Filter\",@sfp)\n\n      SET @sub=InvokeRetrieve(@currSubRequest, @reqStatus)\n      IF RowCount(@sub) > 0 THEN /*Subscriber found */\n        SET @subfield = Row(@sub, 1)\n        SET @activityStatus = Field(@subfield, \"Status\")\n        SET @emailAddress = Field(@subfield, \"EmailAddress\")\n        \n        /* Determine if the subscriber is subscribed or not */\n        IF @activityStatus != \"Active\" THEN /*Subscriber is unsubscribed*/\n          SET @STATUS = @UNSUBBED_FLAG\n        ENDIF\n\n        /* Error out if we dont have an email address */\n        IF EMPTY(@emailAddress) THEN\n          SET @STATUS = @ERROR_NOEMAIL\n          SET @errorMessage = CONCAT(\"No email found for subscriber \",@subscriberKey,\".\")\n        ENDIF\n\n      ELSE/* Subscriber not found */\n        SET @STATUS = @ERROR_NOSUBFOUND\n        SET @errorMessage = CONCAT(\"No subscriber found in All Subscribers with current subscriber key \",@subscriberKey,\".\")\n      ENDIF\n\n    ENDIF\n]%%\n</div>\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n    <link href=\"https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700\" rel=\"stylesheet\">\n\n    <style>\n      \n      \n      html, body {\n  height: 100%;\n}\n\n.toggle {\n  position: relative;\n  display: block;\n  width: 40px;\n  height: 20px;\n  cursor: pointer;\n  -webkit-tap-highlight-color: transparent;\n  transform: translate3d(0, 0, 0);\n}\n.toggle:before {\n  content: \"\";\n  position: relative;\n  top: 3px;\n  left: 3px;\n  width: 34px;\n  height: 14px;\n  display: block;\n  background: #9A9999;\n  border-radius: 8px;\n  transition: background 0.2s ease;\n}\n.toggle span {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 20px;\n  height: 20px;\n  display: block;\n  background: white;\n  border-radius: 10px;\n  box-shadow: 0 3px 8px rgba(154, 153, 153, 0.5);\n  transition: all 0.2s ease;\n}\n.toggle span:before {\n  content: \"\";\n  position: absolute;\n  display: block;\n  margin: -18px;\n  width: 56px;\n  height: 56px;\n  background: rgba(79, 46, 220, 0.5);\n  border-radius: 50%;\n  transform: scale(0);\n  opacity: 1;\n  pointer-events: none;\n}\n\n.cbx:checked + .toggle:before {\n  background: #5d8fda;\n}\n.cbx:checked + .toggle span {\n  background: #24559e;\n  transform: translateX(20px);\n  transition: all 0.2s cubic-bezier(0.8, 0.4, 0.3, 1.25), background 0.15s ease;\n  box-shadow: 0 3px 8px rgba(79, 46, 220, 0.2);\n}\n.cbx:checked + .toggle span:before {\n  transform: scale(1);\n  opacity: 0;\n  transition: all 0.4s ease;\n}\n\n.center {\n  position: absolute;\n  top: calc(50% - 10px);\n  left: calc(50% - 20px);\n}\n      \n      \n      \n      \n      * {\n         font-family: 'Montserrat', sans-serif;\n\n      }\n      h1 {\n        font-size: 42px;\n        font-weight: 600;\n        margin: 0px 0px;\n\n      }\n\n      h2 {\n        font-size: 28px;\n        font-weight: 600;\n        margin: 0px 0px;\n\n      }\n\n      h3 {\n        font-size: 22px;\n        font-weight: 600;\n        margin: 0px 0px;\n\n      }\n      .main-outer {\n        color: #000;\n        font-family: 'Montserrat', sans-serif;\n        font-size: 15px;\n        margin: 0 auto;\n        padding-bottom: 10px;\n        max-width: 1080px; \n      }\n      \n      .main-inner {\n        margin: 50px 20px 0px 20px;\n        \n      }\n      \n      .email-display {\n        text-align:left;\n        border: solid 1px grey; \n        border-radius:8px;\n        padding:0px 10px;\n        width: 450px\n      }\n      \n      .submit-button {\n        background-color: #2659a6;\n        border: none;\n        text-transform: uppercase;\n        border-radius: 20px;\n        text-align: center;\n        padding: 13px 27px;\n        color: white;\n        font-size: 16px;\n        font-weight: 600;\n      }\n      \n      .submit-button:hover {\n        background-color: #3372d1;\n        padding: 14px 29px;\n      }\n      p {\n       color: #808080; \n        margin: 10px 0px;\n\n      }\n      \n      .preference-box-ind {\n        display: inline-block; \n        width:90%; \n        vertical-align: middle;\n        \n      }\n\n      @media only screen and (max-width: 500px) {\n          .mobile-hidden {\n            display: none !important;\n          }\n\n          .email-display {\n            width: 300px; \n\n          }\n\n          .preference-box-ind {\n            width:80%;\n          }\n\n         h1 {\n          font-size: 36px;\n          font-weight: 600;\n          margin: 0px 0px;\n\n        }\n\n        h2 {\n          font-size: 24px;\n          font-weight: 600;\n          margin: 0px 0px;\n\n        }\n\n        h3 {\n          font-size: 20px;\n          font-weight: 600;\n          margin: 0px 0px;\n\n        }\n\n        .submit-button:hover {\n          padding: 14px 29px;\n        }\n\n        }\n      }\n\n    </style>\n  </head>\n\n  <body>\n    <div class=\"main-outer\">\n      <img style=\"width:100%; display:inline;\" src=\"https://via.placeholder.com/1796x933/808080/FFFFFF%20?text=PlaceholderHero\" alt=\"Header\">\n      \n      <div class=\"main-inner\">\n        <h1>\n          Email Preferences\n        </h1>\n        <p>\n          We don't like SPAM either.<br>Choose what you want to hear about below.\n        </p>\n        <br>\n        \n        %%[\n            IF @STATUS == @THANKS_FLAG THEN\n            SET @subscriberKey = RequestParameter(\"subkey\")\n           ]%%\n        <h3>\n          Thank you, your preferences have been updated.\n        </h3>\n\n        <br><br>\n        <form method=\"post\" action=\"%%=CloudPagesURL(\"2117\",\"subkey\",@subscriberKey)=%%\">\n            <input type=\"submit\" value=\"Back to Preferences\" class=\"submit-button\">\n        </form>\n\n        %%[\n            ELSEIF @STATUS < 0 THEN\n          ]%%\n        <h3>\n          An error has occured: %%=v(@errorMessage)=%%<br>Please try again later.\n        </h3>\n        %%[\n          ELSE\n          ]%%\n        \n        <div class=\"email-display\">\n\n          <div style=\"display: inline-block; vertical-align: middle;\">\n            <img style=\"width:40px; display:inline;\" src=\"https://e7.pngegg.com/pngimages/522/873/png-clipart-black-envelope-icon-advanced-case-management-envelope-computer-icons-icon-design-envelope-mail-miscellaneous-angle.png\" alt=\"Email:\">\n          </div>\n          \n          <div style=\"display: inline-block; padding-left: 10px;  vertical-align: middle;\">\n            <p style=\"color:#b8b8b8;font-size:14px\">\n              %%=v(@emailAddress)=%%\n            </p>\n          </div>\n        </div> <!-- email display -->\n        <br><br>\n\n        \n        \n        <form method=\"post\" action=\"%%=CloudPagesURL(\"2116\",\"subkey\",@subscriberKey)=%%\">\n          %%[\n              IF @STATUS == @UNSUBBED_FLAG THEN\n            ]%%\n          <hr><br>\n          <div class=\"preference-box-ind\">\n            <p id=\"paragraph\">If you would like to resubscribe into our marketing and promotional emails, please check the box then click \"Update Preferences.\"</p>\n          </div>\n          \n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" name=\"resubscribe\" id=\"cbxresubscribe\" style=\"display:none\"/>\n            <label for=\"cbxresubscribe\" class=\"toggle\"><span></span></label>\n          </div>\n         <br><br><hr>\n          \n          <br><br>\n          <input type=\"Submit\" value=\"Update Preferences\" class=\"submit-button\">\n          %%[\n           ELSE\n\n                  /* Get all the preferences in this BU from the DE SubscriberPreferences*/\n                  SET @preferenceRows = LookupOrderedRows(\"PreferenceCenter\", 0, \"SortOrder ASC\", \"IsActive\", \"True\")\n                  SET @preferenceCount = ROWCOUNT(@preferenceRows)\n\n                  /* Get all the preferences for this specific subscriber*/\n                  SET @subsPreferenceRows = LookupRows(\"SubscriberPreferences\", \"SubscriberKey\", @subscriberKey)\n                  SET @subPreferenceCount = ROWCOUNT(@subsPreferenceRows)\n\n                  SET @override = false\n                  IF @subPreferenceCount == 0 THEN\n                    Redirect(CloudPagesURL(2116,\"subkey\",@subscriberKey))/* Not updated yet, try again.*/\n                  ENDIF\n\n                  IF @preferenceCount != 0 THEN \n                      SET @subsPrefs = ROW(@subsPreferenceRows, 1)\n\n                      FOR @i = 1 TO @preferenceCount DO\n                          SET @prefCurrRow = ROW(@preferenceRows, @i)\n\n                          SET @preferenceId = FIELD(@prefCurrRow, \"PreferenceId\")\n                          SET @label = FIELD(@prefCurrRow, \"PreferenceLabel\")\n                          SET @description = FIELD(@prefCurrRow, \"PreferenceDescription\")\n\n\n                          SET @subOptInValue = Lookup(\"SubscriberPreferences\", \"OptinStatus\", \"SubscriberKey\", @subscriberKey,\"Preference\",@preferenceId)\n\n              ]%%\n          <div class=\"preference-box-ind\">\n            <h3>\n              %%=v(@label)=%%\n            </h3>\n            <p class=\"description\" >\n              %%=v(@description)=%%\n            </p> \n          </div>\n\n          %%[IF @subOptInValue == \"True\" THEN]%%\n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" name=\"%%=v(@preferenceId)=%%\" checked id=\"cbx%%=v(@preferenceId)=%%\" style=\"display:none\"/>\n            <label for=\"cbx%%=v(@preferenceId)=%%\" class=\"toggle\"><span></span></label>\n          </div>\n          %%[ELSE]%%\n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" name=\"%%=v(@preferenceId)=%%\" id=\"cbx%%=v(@preferenceId)=%%\" style=\"display:none\"/>\n            <label for=\"cbx%%=v(@preferenceId)=%%\" class=\"toggle\"><span></span></label>\n          </div>\n          %%[ENDIF]%%\n           <br><br>\n\n          \n          %%[ \n              NEXT \n             ENDIF /* ENDIF for preferences check*/\n            ]%%\n          \n          <hr><br>\n          <div class=\"preference-box-ind\">\n            <h3>\n             Opt out of all [COMPANY NAME] Communications\n            </h3>\n          </div>\n\n          <div style=\"display: inline-block; padding-left: 10px; vertical-align: middle;\">\n            <input class=\"cbx\" type=\"checkbox\" id=\"cbxunsub\" name=\"unsubscribe\" style=\"display:none\"/>\n            <label for=\"cbxunsub\" class=\"toggle\"><span></span></label>    \n          </div>\n          <br><br><hr>\n          \n          <br><br>\n          <input type=\"Submit\" value=\"Update Preferences\" class=\"submit-button\">\n          %%[ \n          ENDIF /* ENDIF for \"IF @STATUS == @UNSUBBED_FLAG THEN\" block*/\n         ENDIF /* ENDIF for \"IF @STATUS == @THANKS_FLAG THEN\" block*/\n         ]%%\n\n        </form>\n      </div>\n    </div>\n  </body>\n</html>\n\n\t\t</div>\n\t</div>\n</div>\n</body>\n</html>\n","isDefault":true,"isStaticContent":false,"name":"CPC_Main"},"definition":{"collectionId":"{{mcpm#/entities/cloudPageCollections/1125/data/collectionId}}","description":"Custom preference center main page","domain":"{{mcpm:cloudPages-domain}}","isNoFollow":false,"isNoIndex":false,"key":"jqi02yqkmgp","name":"cpc_main","pageTypeId":3,"requiresSsl":true,"url":"https://mcf7bhdjzswk278tj2j38nqtlq2q.pub.sfmc-content.com/jqi02yqkmgp"},"name":"cpc_main","state":{"contentType":"text/html","description":"","name":"cpc_main"}}}},"queryActivities":{"955881f4-6cb6-4ff3-917e-0e26af7f7c42":{"issues":[],"originID":"955881f4-6cb6-4ff3-917e-0e26af7f7c42","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"name":"FSP021_UpdatePrefApples","categoryId":"{{mcpm#/entities/categories/418750/data/id}}","description":"","isFrozen":false,"queryText":"SELECT\ns.SubscriberKey AS PF_SubscriberKey,\nCASE\n    WHEN s.OptinStatus = 'TRUE' THEN 'TRUE'\n    WHEN s.OptinStatus = 'FALSE' THEN 'FALSE'\nEND AS PF_Apples\nFROM {{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/namePrefix}}[{{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/name}}] s\nJOIN {{mcpm#/entities/dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421/data/namePrefix}}[{{mcpm#/entities/dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421/data/name}}] p ON s.SubscriberKey = p.PF_SubscriberKey\nWHERE Preference = 'Apples'\nGROUP BY s.SubscriberKey, s.OptinStatus","targetId":"{{mcpm#/entities/dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421/data/id}}","targetUpdateTypeId":1,"targetUpdateTypeName":"Update"}},"ef1dbe3f-9166-4c80-9cd4-b3f03dac00db":{"issues":[],"originID":"ef1dbe3f-9166-4c80-9cd4-b3f03dac00db","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"name":"FSP041_UpdatePrefGrapes","categoryId":"{{mcpm#/entities/categories/418750/data/id}}","description":"","isFrozen":false,"queryText":"SELECT\ns.SubscriberKey AS PF_SubscriberKey,\nCASE\n    WHEN s.OptinStatus = 'TRUE' THEN 'TRUE'\n    WHEN s.OptinStatus = 'FALSE' THEN 'FALSE'\nEND AS PF_Grapes\nFROM {{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/namePrefix}}[{{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/name}}] s\nJOIN {{mcpm#/entities/dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421/data/namePrefix}}[{{mcpm#/entities/dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421/data/name}}] p ON s.SubscriberKey = p.PF_SubscriberKey\nWHERE Preference = 'Grapes'\nGROUP BY s.SubscriberKey, s.OptinStatus","targetId":"{{mcpm#/entities/dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421/data/id}}","targetUpdateTypeId":1,"targetUpdateTypeName":"Update"}},"707c95b8-6dcc-4bc8-922b-2f86e3ac2ca6":{"issues":[],"originID":"707c95b8-6dcc-4bc8-922b-2f86e3ac2ca6","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"name":"FSP031_UpdatePrefOranges","categoryId":"{{mcpm#/entities/categories/418750/data/id}}","description":"","isFrozen":false,"queryText":"SELECT\ns.SubscriberKey AS PF_SubscriberKey,\nCASE\n    WHEN s.OptinStatus = 'TRUE' THEN 'TRUE'\n    WHEN s.OptinStatus = 'FALSE' THEN 'FALSE'\nEND AS PF_Oranges\nFROM {{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/namePrefix}}[{{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/name}}] s\nJOIN {{mcpm#/entities/dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421/data/namePrefix}}[{{mcpm#/entities/dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421/data/name}}] p ON s.SubscriberKey = p.PF_SubscriberKey\nWHERE Preference = 'Oranges'\nGROUP BY s.SubscriberKey, s.OptinStatus","targetId":"{{mcpm#/entities/dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421/data/id}}","targetUpdateTypeId":1,"targetUpdateTypeName":"Update"}},"43d48268-07e3-4c31-be08-e60000f5edfa":{"issues":[],"originID":"43d48268-07e3-4c31-be08-e60000f5edfa","originEID":"mcf7bhdjzswk278tj2j38nqtlq2q","data":{"name":"FSP011_StageSubscriberRecords","categoryId":"{{mcpm#/entities/categories/418750/data/id}}","description":"","isFrozen":false,"queryText":"SELECT\nSubscriberKey AS PF_SubscriberKey\nFROM {{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/namePrefix}}[{{mcpm#/entities/dataExtensions/2634db59-79a9-ed11-b866-48df376a1421/data/name}}]\nGROUP BY SubscriberKey","targetId":"{{mcpm#/entities/dataExtensions/d3ebbe8a-9ea9-ed11-b866-48df376a1421/data/id}}","targetUpdateTypeId":0,"targetUpdateTypeName":"Overwrite"}}},"scriptActivities":{},"sendDefinitions":{},"sharedDataExtensions":{},"siteMapVersions":{},"subscriberLists":{},"verificationActivities":{}},"selectedEntities":{"assets":[],"attributeGroups":[],"automations":["062a48b9-6e6b-436e-8789-0f4b18100d87"],"cloudPageCollections":["1125"],"dataExtensions":["2634db59-79a9-ed11-b866-48df376a1421","2734db59-79a9-ed11-b866-48df376a1421"],"journeys":[],"journeyTemplates":[],"sharedDataExtensions":[]}}